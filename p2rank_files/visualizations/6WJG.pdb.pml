
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/6WJG.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/6WJG.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [3108,3693,3109,3747,3822,3982,4128,4129,4130,3978,3998,1712,4226,4228,1788,4223,4225,4251,1846,4250,3160,3175,3178,1635,3694,1713,1655,1664,3742,3743,3759,3746,3985,4221,4222,4126,4114,4124,3658,4229,3619,3634,3653,3657,1668,3126,3127,3128,3129,3131,3512,3536,3537,3125,3766,3905,3013,3015,3961,3962,3532,3819,3760,3818,3820,3823,3836,3842,3838,3857,3547,3551,3090,3107,3061,3062,2985,2986,3008,2987,2988,2989,2990,2993,1767,1828,1785,1825,1787,1827,2995,3161,3163,3164,3018,3072,3073,3256,3258,3016,3239,3237,3240,3440,3438,3439,3436,3437,3457,3459,2771,3494,3503,3509,3441] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.412,0.702]
select surf_pocket2, protein and id [12374,11175,11176,11234,12378,12380,11990,11982,11991,11547,11549,11550,11586,11587,12346,12368,10882,10883,10891,10895,10940,10942,11000,11002,10836,11233,10884,11600,10977,10980,12553,2835,11115,12610,11112,12623,12031,10941,10979,12074,12465,12467,12469,12552,12533,12028,12027,11054,10976,11055] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.482,0.902]
select surf_pocket3, protein and id [10361,10362,10363,185,186,191,194,196,202,203,172,184,225,206,207,208,210,798,728,780,690,731,732,733,730,729,10308,4769,4771,173,612,631,636,635,2180,2143,2144,2145,2113,2406,2446,1476,14403,14404,10328,10329,2181,10327,10359,10360,10369,2658,10372,2448,2665,2666,2668,10324,166,505,1443,2228,257,258,259,2390,2391,2403,1344,2227,2359,474,1358,1397,4745,4719,4724,4725,4727,4738,4742,4743,4726,4728,1394,4741,147,164,165,150,4680,1378,4685,2177,2178,2194,2176,1474,1492,1442,14378,14402,10389,688,687] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.341,0.702]
select surf_pocket4, protein and id [14588,13537,13539,13540,13500,13501,13502,13561,14146,13451,13454,13444,13396,13392,13535,13442,13443,13450,14109,14110,14142,14147,14632,14634,14557,14591,14547,14550,14157,14542,14160,7920,14631,13557,13558,13560,13562,13615,13536,13735,13794,13455,15023,15024,15025,15029,14940,7943,15112,15113,15021,15039,15040,15046] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.392,0.902]
select surf_pocket5, protein and id [5251,5252,5268,5361,5362,7281,6539,6543,6544,6545,6546,6547,7280,7298,7507,7495,5609,7493,7494,5363,6449,7332,6480,6482,6462,7331,5578,6446,6475,6178,6179,6448,7282,7283,7285,12884,12888,7249,12887,5313,5314,5315,5316,5274,5277,5280,7508,5311,5312,7510,6596,6592,9849,9829,9831,9875,9870,9871,9873,6578,6575,6533,11844,12835,12836,12861,12867,12868,12866,11819,11863,9811,6643,6642,11841,11842,11818] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.290,0.278,0.702]
select surf_pocket6, protein and id [8152,8213,8851,8839,8845,8850,9354,9287,9289,9291,9307,8150,6949,8097,8099,9105,9086,9102,9103,9232,8797,8798,8268,8211,8212,6817,9352,9353,9355,6889,6892,6816,9228,9233,9218,8921,8927,8847,8910,8913,8835,8090,8089,8091,9063,9064,9066,9062,9082] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.424,0.361,0.902]
select surf_pocket7, protein and id [7442,6916,6912,6914,6915,6868,6870,6925,6869,6888,6889,6558,7444,6559,6873,6875,6877,9617,9618,6871,6872,7349,7351,7479,7443,9606,6140,6984,6910,6911,7244,7295,7313,8194,6930,6932,7228,7174,7172,6985,7175,7267,7312,8192,8266,8267,8268,8211,7264,7266,7311,8253,8193,8250,8251,6571,6572,6626,6561] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.365,0.278,0.702]
select surf_pocket8, protein and id [5833,5884,5740,5649,5648,5902,5886,7550,7536,7537,5897,5903,10152,10151,12922,7552,12923,5299,5307,5310,7509,5298,5309,5645,7551,7515,7519,7520,7522,5951,5952,7535,6415,6416,6449,5609,7504,7503,5608,5607,5949,6031,6028,6448,6176,6447,6192,6217,6161,6030,5834,12945,12950,5835,5836,5837,12949,5716,5794,12918,12920,12921,12948] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.514,0.361,0.902]
select surf_pocket9, protein and id [1504,1771,1773,4522,4525,4526,1697,1698,1699,1700,1701,4512,4513,4514,4502,1502,1503,1638,1640,1457,1812,2338,2340,2307,1428,1429,2245,2246,4566,4562,4565,4567,2247,1438,1492,1498,2315,2312,2314,2306,4711,4708,4583,4575,4581,4529,4531,4532,1565,1566,14424,14425,1505,1506,1507,4709,4710,4707,4696,4705,1587,1589,1588,14458,14460,14260] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.435,0.278,0.702]
select surf_pocket10, protein and id [2417,2419,2421,2045,2462,2027,2029,2030,1056,1998,1054,1057,2461,906,907,908,2416,2418,2420,959,960,972,1072,1111,1952,2062] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.608,0.361,0.902]
select surf_pocket11, protein and id [1767,1766,1826,1828,2208,2209,1951,1881,1897,1880,3048,1821,1822,1812,2337,2339,1039,1769,1808,1807,1806,1455,3163,3164,3090,3047,2070,2124,2160,2162,2140,2191,2206,2375] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.510,0.278,0.702]
select surf_pocket12, protein and id [10231,14436,14437,14310,14309,14311,14761,14764,14271,14270,14477,14478,8438,8424,10210,10215,10217,8439,14577,14578,14755,14728,14733,14751,14564,14566,14792,13995,14561,14618,14622,14089,14735,14120,14124,14126,14603,14606,14705,14716] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.698,0.361,0.902]
select surf_pocket13, protein and id [7566,6012,6011,7056,5949,6031,6024,6025,6028,7054,6982,7133,7518,7519,7166,7520,7521,5952,6075,6107,6030,7030,7031,7032,6161,6137,6159,6160,6104,6176,6138,6984,6980,7035,7149] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.580,0.278,0.702]
select surf_pocket14, protein and id [12039,12043,12044,12045,12024,3350,12032,3317,3318,11877,12770,12775,12777,3320,12145,12156,12191,12193,12195,12017,12018,12175,12201,12205,12058,12059,12062,12173,11751,12194,11989,11917,11918,11916,11876,11710,12003,11709,11711,12114,12112] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.792,0.361,0.902]
select surf_pocket15, protein and id [14670,14672,8510,8512,8508,7745,7922,7924,7918,14653,7744,7746,14650,14651,7901,7791,7794,7846,7795,7847] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.651,0.278,0.702]
select surf_pocket16, protein and id [4075,4077,4009,4010,4011,4000,4001,4005,4006,4129,4130,3999,1845,4146,4086,4063,1968,1969,1972,1970,1910,2991,1893,2994,2948,2949,2930,2989,2933,2934,2916] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.886,0.361,0.902]
select surf_pocket17, protein and id [8281,6739,8264,8279,8282,8743,8745,8757,8762,8761,6758,6759,6772,6767,8797,8212,6817,6768,8723,6718] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.702,0.278,0.675]
select surf_pocket18, protein and id [12113,2689,10375,12111,2639,12090,2641,2743,2814,2816,2818,2797,3406,3407,3408,2688,2742,10374,2637,2638,2687,2690,12046,12088,12091,12092,12094,2856] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.902,0.361,0.824]
select surf_pocket19, protein and id [2900,2901,2897,2899,2675,2742,2677,2678,2801,2960,2915,2977,2048,2914,2636,2654,2624,2090,2656,2657,2666,2672,2085,2083,2087,2639,2642,2800] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.702,0.278,0.604]
select surf_pocket20, protein and id [10400,12090,12089,2641,2600,2603,12571,2601,12105,10397,10406,10409,10410,2855,2852,12071,12468,12552,12088,2856,12094,12484,12485,12411] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.902,0.361,0.729]
select surf_pocket21, protein and id [5963,6270,6375,6269,5959,5960,5966,5964,5965,10192,10193,10194,6415,6416,6376,6218,6217,10146,10147,10149,5900,5903] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.702,0.278,0.533]
select surf_pocket22, protein and id [848,2386,2399,2400,2411,2418,2420,1345,907,503,2389,2390,1344,1073,1074,1072,1113,1111,904,972,1309,501,211] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.902,0.361,0.639]
select surf_pocket23, protein and id [1293,1294,1176,1177,1179,1181,1221,1288,1289,1290,1291,1292,1178,1164,72,73,486,487,30,17,19,20,37,39,1,2,13,33,1328,1144] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.278,0.459]
select surf_pocket24, protein and id [5628,5630,6396,6394,6398,5591,9995,5110,5111,5112,6393,6395,6397,5175,5176,5379,5137,5138,5590,5107,9969,9991,5629,9953] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.361,0.545]
select surf_pocket25, protein and id [7188,7189,8065,7763,7190,7191,7998,8003,7152,7991,7153,8017,7693,7193,7194,7576,7577,7822,7769,7770,7758,7760,7761,7904,8005,7729,7730,7725] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.278,0.388]
select surf_pocket26, protein and id [12004,12230,12231,12232,11435,11564,11567,11569,11412,11416,11417,12001,11562,11563,12330,11326,11383,11418,11325,11284] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.361,0.451]
select surf_pocket27, protein and id [8506,8509,13521,14605,8510,14652,7924,7923,14653,14654,14599,8454,14589,14600,14588,13539,13501,13518,8453] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.278,0.318]
select surf_pocket28, protein and id [6608,6610,9634,9684,6693,9636,9814,9802,9679,9683,6666,6668,6691,11699,11662,11664,11700,11901,12273,12274] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.361,0.361]
select surf_pocket29, protein and id [6947,6965,6966,6967,6948,6950,9181,9231,9191,9229,9230,9233,9246,9247,9251,9419,9425,9427,9252,7017,7020,7018,9189,9395,9393,9394,6898,6899,6902] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.318,0.278]
select surf_pocket30, protein and id [636,635,749,5046,5044,1271,573,748,542,210,545,798,728,799,729,544] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.451,0.361]
select surf_pocket31, protein and id [8230,8231,8167,8177,8229,8233,8636,8640,8641,8344,8176,8945,8235,8616,8343,8544,8360,8362,8542,8541] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.388,0.278]
select surf_pocket32, protein and id [3348,3405,12030,12094,10941,10979,10978,12046,12028,12027,12091,12092,10960,10958,10973,2818,2819,2820,3407,3402] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.545,0.361]
select surf_pocket33, protein and id [1538,1539,1540,14402,14423,14400,10270,10273,1474,1488,1491,4745,1476,1477,14403,14404,14437,14310] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.459,0.278]
select surf_pocket34, protein and id [2373,2419,2375,1033,1057,1878,1880,1950,1034,1928] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.639,0.361]
select surf_pocket35, protein and id [6581,8327,8330,8331,12846,12832,12892,8254,6646,12792,12827,12795,6644,12851] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.533,0.278]
select surf_pocket36, protein and id [8098,9115,9126,6997,7076,7074,8038,9145,9143,9234,7014,7017,7018,9167,9179,6947,6945,6948,9181,8036] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.902,0.729,0.361]
select surf_pocket37, protein and id [5937,5869,5887,7580,5889,12985,5870] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.702,0.604,0.278]
select surf_pocket38, protein and id [4247,4249,4246,4248,4250,4289,4290,4291,4299,1845,4147,4149,4311,4143,1862,1795,1798,1797,4315,4312,4371,1844] 
set surface_color,  pcol38, surf_pocket38 
set_color pcol39 = [0.902,0.824,0.361]
select surf_pocket39, protein and id [7642,7071,7072,7121,8037,8038,9149,9150,7640,8023,8019,8020,8035] 
set surface_color,  pcol39, surf_pocket39 
set_color pcol40 = [0.702,0.675,0.278]
select surf_pocket40, protein and id [14791,14789,14890,14891,14239,13943,13976,13978,13885,13886,13977,14127,14129,14130,14788,14822] 
set surface_color,  pcol40, surf_pocket40 
set_color pcol41 = [0.886,0.902,0.361]
select surf_pocket41, protein and id [9007,9009,9116,8034,8036,8091,8092,8994,9065,9066,8052,8053,9115,8094] 
set surface_color,  pcol41, surf_pocket41 
set_color pcol42 = [0.651,0.702,0.278]
select surf_pocket42, protein and id [6393,6395,6397,6280,6325,6396,6394,6398,5591,5112,6281,6282,6283,5106,5137,5138,5107,5117] 
set surface_color,  pcol42, surf_pocket42 
   
        
        deselect
        
        orient
        