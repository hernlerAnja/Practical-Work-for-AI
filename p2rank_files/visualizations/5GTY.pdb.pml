
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/5GTY.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/5GTY.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [8688,17884,17911,17912,8687,8689,8730,17885,8682,8686,8751,8753,8754,8786,8656,8660,8661,8663,8670,8646,8648,18443,8690,17853,17876,17844,17850,17851,17852,18066,18067,8785,18065,18074,8817,8821,8822,8824,17872,8761,1970,1971,1973,17107,17103,17104,17105,2036,2038,17135,17136,17137,17131,17143,17144,17145,1996,17142,17859,17863,17865,17866,17132,18434,18436,17157,18440,18441,18442,18427,18424,18433,18058,8676,8679,1795,8659,2106,8651,1852,1853,1854,1933,1972,2007,2009,2011,1821,8685,2005,2044,2002,2034,2107,2108,2033,8654,1969,1791,1792,1828,1819,1830,2045,2046] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.420,0.702]
select surf_pocket2, protein and id [10062,10063,10070,10074,10075,10076,4371,10066,10067,10073,4370,4437,4439,4381,4368,4369,4373,10803,4314,4346,4322,4344,4345,4312,4310,4320,4389,4391,4392,4393,6342,6356,6357,6358,4402,6345,4390,10068,4142,4139,4175,4177,10816,10820,10813,10814,4171,4176,4275,4276,4313,4347,6349,6351,6364,6365,6366,11381,6363,6359,6362,6354,6389,6390,6459,6461,6462,6391,6392,6393,6379,6382,6385,6388,4197,4166,6493,6494,10807,10809,11371,11374,11367,11372,11002,10795,10796,10788,10794,11016,11018,10815,11378,11362,6469,6436,11009,11010,11011,6531] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.502,0.902]
select surf_pocket3, protein and id [1844,1845,1882,7763,7767,8500,8502,8489,1787,8513,8508,8509,1876,1883,1887,1888,1891,1864,1881,1842,1863,1875,1820,8702,8703,8704,8705,8706,1822,8492,9061,9064,8709,8711,9048,8503,9053,9058,9060,9063,8487,8481,1700,1714,1715,1717,1718,1813,1743,1812,1713,7770,7762,1698,1810] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.361,0.702]
select surf_pocket4, protein and id [6208,5477,5486,5474,5476,4047,4057,6197,6221,6214,6216,6217,5479,6220,5445,5446,5478,6204,6189,6195,6196,6412,6414,6210,6211,4134,4091,4157,4159,4191,4192,4062,4060,4061,4160,4083,4087,4167,4169,6405,6406,6407,4045,5483,6748,6753,6758,6760,6763,6764,4233,4224,4225,4064,4189,4065,4206,4207,4219,4226,4218,4063,4230,6228,6215,5447,5448] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.427,0.902]
select surf_pocket5, protein and id [13151,12408,13144,13152,10953,12409,12410,12411,13730,11060,11062,10968,10970,11092,11094,11095,11037,13167,13168,13359,13358,13357,13155,13157,13158,13366,13721,13716,13723,13727,11131,11132,11072,13142,13143,13136,10967,11063,10996] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.278,0.302,0.702]
select surf_pocket6, protein and id [16546,16674,17000,17449,17002,17448,17023,17050,17038,17047,16683,16687,16981,16982,16983,16985,16547,16689,16545,16499,16500,16505,16501,16502,16504,17031,17537,16690,16691,17420,17433,17419,17055,17051,17054,1962,17079,16516,16519,16506,16824,16825,16986,17528,17531,17536,17530,17529,17545,17547,16907,16905,16999,17001,16887,16822,17535,17558,17559,17541] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.369,0.361,0.902]
select surf_pocket7, protein and id [9986,10364,10350,10380,10468,10379,9612,9951,9931,9933,9979,9980,9981,9985,9978,9627,9628,9629,9625,9914,9913,10460,10459,10461,10466,10467,10490,9818,9824,9930,9932,9833,9836,9757,9917,9838,10352,4305,9447,9457,9450,9452,9453,9440,9441,9446,9485,9487,9486,9442,9444,9445,10010,9969,9954,9962,9460] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.314,0.278,0.702]
select surf_pocket8, protein and id [14690,15092,14143,14666,14667,14140,14146,14139,14141,14668,15091,14681,14674,14550,14644,15170,14338,14339,14325,14331,14335,14184,14186,14185,15188,14530,14548,14626,14628,14466,14468,15061,15062,15063,14693,14698,14147,14149,14722,15186,15076,15172,15178,15171,15177,14156,14152,14151,14155,15200,14719,14663,14320,14321,14322,14642,14643,14535,14624,14625,14544,14545,15064] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.443,0.361,0.902]
select surf_pocket9, protein and id [352,354,355,201,203,202,158,159,150,152,156,157,712,699,708,711,151,1216,1210,489,552,1197,1198,1199,1229,1117,1118,1204,1205,1088,1091,1092,1093,716,162,160,163,715,740,356,1206,1200,1207,662,663,667,684,686,569,644,647,571,661,154,155,679,339,348,486,550,551,565] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.373,0.278,0.702]
select surf_pocket10, protein and id [7338,7339,7336,8068,8069,7630,7631,7614,7679,7652,7667,7676,7653,7654,7323,7649,7629,8040,8053,7684,8039,8154,8155,8156,8042,8147,7151,7191,7140,7146,7147,7149,7708,7143,7189,7190,7660,7647,7332,7152,7155] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.518,0.361,0.902]
select surf_pocket11, protein and id [5866,5858,5867,5753,5782,5783,4908,4867,4872,4906,4907,4862,4865,4868,4855,4856,5041,5040,5360,4858,4860,5341,5343,5344,5396,5397,5421,5389,5392,5362,5365,5373,5055,5056,5057,5327,5043,5049,5053,5324,5044] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.431,0.278,0.702]
select surf_pocket12, protein and id [10989,10966,10983,6663,6665,12418,10958,10959,10962,10952,10954,10955,10963,6605,6606,6608,6607,13176,13177,6631,6633,6635,6503,13204,10992,10994,10995,10996,13175,6440,6468,6441,10986,6673,6733,6734,6735,6662,6473,6499,6500,6501,6502,6477,6478,6620,6641,6637,6638,6578,6611,13203,13151,12408,10944,10953,12409,12411,12376,12417,13164,13167,13168,12380,12377,12379] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.592,0.361,0.902]
select surf_pocket13, protein and id [2725,2530,2577,2578,2579,2718,2722,2724,2527,2528,2532,3554,2913,3553,3026,3027,3473,3474,2846,2911,2912,3572,3025,3038,2926,2930,2932,2918,2927,3024,3007,2709,2708,3043,2726,2533,2534,2536,2539,2543,3444,3458,3561,3562,3010,3584,2850,3008,3050,3045,3048,3056,3072,2531,3080,3104,3446] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.490,0.278,0.702]
select surf_pocket14, protein and id [11783,12294,12723,12297,12321,12324,12305,12312,12329,12693,12704,12721,12722,11968,11972,11824,11825,11826,11959,11962,12280,11957,11958,12274,12275,12276,12800,12802,11796,11976,12698,12810,12256,11780,11781,12353,11787,11789,11791,11792,11795,11786] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.667,0.361,0.902]
select surf_pocket15, protein and id [12433,12459,12460,12461,12465,12423,12463,13855,12761,13854,13785,13789,13775,12750,12751,12363,12364,12502,12503,12317,12362,12400,12402,12424] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.549,0.278,0.702]
select surf_pocket16, protein and id [40,576,579,42,61,248,246,247,249,333,577,654,319,242,244] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.741,0.361,0.902]
select surf_pocket17, protein and id [9844,9845,9934,9843,9849,9335,9336,9337,9357,9924,9525,9526,9527,9528,9529,9530,9531,9532,9606,9928,9533] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.608,0.278,0.702]
select surf_pocket18, protein and id [12888,12892,13181,13188,13198,12903,12904,12905,13173,13184,13166,13170,13174,12694,12696,12695,12345,12381,12900,12902,13123,12671,12870,12873,12876,12884,12890,12865,6586,6609,6612,13203,6556,6557] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.816,0.361,0.902]
select surf_pocket19, protein and id [14832,14834,15129,16152,14770,14771,16141,16148,16149,14732,15118,15119,14731,14733,14792,14798,14802,14804,14805,14791,14769,14793,14830,16217] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.663,0.278,0.702]
select surf_pocket20, protein and id [2620,2703,2621,2622,2623,2625,2618,2619,2694,2624,2938,2940,3018,2937,2418,2438,2437] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.890,0.361,0.902]
select surf_pocket21, protein and id [5260,5034,4952,5020,4954,5257,5258,5335,4953,4947,4948,4949,4950,4951,4747,4748,5263,4768] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.702,0.278,0.678]
select surf_pocket22, protein and id [12187,12189,11865,11867,11869,11870,11871,11872,11953,12267,11674,11671,11672,11673,11692,11693,11868] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.902,0.361,0.835]
select surf_pocket23, protein and id [7752,7753,7754,7718,7719,8097,7776,7777,7779,7775,7787,7781,7788,7817,9101,7812,7813,7814,7815,7816,8107,8096] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.278,0.620]
select surf_pocket24, protein and id [8147,8149,8150,7453,8160,7530,7451,7534,7536,7517,7338,7339,7340,7336,7630,7614,8179,7612,7628,7629,8154,8156,7516,8164,7450] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.361,0.757]
select surf_pocket25, protein and id [16913,16915,16395,16396,16397,16398,16399,16417,16586,16668,16588,16589,16590,16591,16592,16593,16993] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.278,0.561]
select surf_pocket26, protein and id [7622,7317,7051,7030,7232,7234,7235,7236,7237,7031,7029,7540,7541,7542,7544,7230] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.361,0.682]
select surf_pocket27, protein and id [5632,11780,5633,6600,6603,6585,12353,11789,11792,11786,5670,5669,12329,12694,12345,12381,12352,12698] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.278,0.502]
select surf_pocket28, protein and id [1734,1735,15765,15763,15764,15759,15762,1713,1733,1709,1590,1615,16051,1707,1708,15990,16062,16064,16002,1512,1728,1571,1585] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.361,0.608]
select surf_pocket29, protein and id [2179,897,847,848,849,850,851,852,750,751,786,788,816,822,810,821,846,823,1147,2191,1146,2190] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.278,0.443]
select surf_pocket30, protein and id [5497,5500,5501,5528,5530,5491,5468,5470,5431,5432,5567,5568,6815,5811,5812,6797,6801,6804] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.361,0.533]
select surf_pocket31, protein and id [14556,14555,14029,14636,14051,14030,14558,14640,14646,14647,14316,14641,14031,14032,14225,14227,14228,14229,14230,14231,14232,14302] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.278,0.388]
select surf_pocket32, protein and id [5889,5074,5071,5073,5070,5088,5905,5137,5328,5273,5309,5310,5311,5113,5116,5115,5139,5143,5170,5903,5907,5910,5904] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.361,0.459]
select surf_pocket33, protein and id [11045,11250,11251,11252,11253,11347,11349,11277,11275,13303,13314,13331,13334,13337,13341,13342,13316,11279,13413,13414,13343,13344] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.278,0.329]
select surf_pocket34, protein and id [11419,10080,10086,10093,10020,10021,10409,11426,10120,10122,10119,10121,11442,11441,10117,10118,10159,10408,11417,11423,10056,10058] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.361,0.384]
select surf_pocket35, protein and id [3211,3212,4516,3151,3213,3214,3215,3216,3153,3114,3502,3503,3115,3174,3184,3187] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.290,0.278]
select surf_pocket36, protein and id [5608,5632,5638,11773,5606,11767,11768,11769,5609,5611,5612,5613,6948,6954,6957,6628,5640,5210,5211,6947,6950,5219,5221,5204] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.902,0.412,0.361]
select surf_pocket37, protein and id [12089,12635,12632,12629,12634,12064,12092,12636,12639,12817,12098,12097,12814,12823,12843] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.702,0.349,0.278]
select surf_pocket38, protein and id [17158,17159,17161,17089,17123,17126,17149,17155,17090,17477,17185,17186,17188,17191,17228,17187,17189] 
set surface_color,  pcol38, surf_pocket38 
set_color pcol39 = [0.902,0.486,0.361]
select surf_pocket39, protein and id [5167,5327,5246,5250,5252,5877,5890,5875,5871,5169,5170,5861,5866,5854,5858,5860,5232,5344] 
set surface_color,  pcol39, surf_pocket39 
set_color pcol40 = [0.702,0.408,0.278]
select surf_pocket40, protein and id [4690,4528,4529,3211,3212,3213,3214,3215,3216,3241,3248,3250,3508,3510,3506,4686,3199,3201,3203,3204,3238,3206,3207] 
set surface_color,  pcol40, surf_pocket40 
set_color pcol41 = [0.902,0.561,0.361]
select surf_pocket41, protein and id [10846,10847,10979,10980,10930,10931,10543,10974,10741,10969,10971,11116,11117,11118,11120,10710,10707] 
set surface_color,  pcol41, surf_pocket41 
set_color pcol42 = [0.702,0.463,0.278]
select surf_pocket42, protein and id [7876,7878,8102,8103,9261,9262,9265,7875,8112,7504,7505,8115,8113,8114,9250,9187,9188,9218,9232,9246,9146,9254,9249,8091,8106,9216,9219,9217] 
set surface_color,  pcol42, surf_pocket42 
set_color pcol43 = [0.902,0.635,0.361]
select surf_pocket43, protein and id [1079,1271,1065,1066,1274,1300,1301,1302,1091,1092,1093] 
set surface_color,  pcol43, surf_pocket43 
set_color pcol44 = [0.702,0.522,0.278]
select surf_pocket44, protein and id [15076,15176,15178,15177,14156,14159,14152,14151,14155,15201,14164,14168,14169,14339,14186,15040,14163,15065,15066] 
set surface_color,  pcol44, surf_pocket44 
set_color pcol45 = [0.902,0.710,0.361]
select surf_pocket45, protein and id [1546,1512,1544,1566,1567,15755,15757,15790,1571,1757,1758,15792,1732,1739,1746,1734,1735,15824,15823,15789,1733] 
set surface_color,  pcol45, surf_pocket45 
set_color pcol46 = [0.702,0.580,0.278]
select surf_pocket46, protein and id [7356,7615,7598,8202,7357,7401,7402,7422,8194,8195,8196,7453,8178,7423,7424,7427] 
set surface_color,  pcol46, surf_pocket46 
set_color pcol47 = [0.902,0.784,0.361]
select surf_pocket47, protein and id [5964,6109,6106,6107,6328,5933,5941,6247,6514,6517,6520,6140,6375,6376,6248,6370,6329,6367] 
set surface_color,  pcol47, surf_pocket47 
set_color pcol48 = [0.702,0.639,0.278]
select surf_pocket48, protein and id [15835,15838,15841,15566,15458,15425,15260,15567,15428,15651,15687,15694] 
set surface_color,  pcol48, surf_pocket48 
set_color pcol49 = [0.902,0.859,0.361]
select surf_pocket49, protein and id [13194,13195,13322,13312,13273,13053,13469,13315,13056] 
set surface_color,  pcol49, surf_pocket49 
set_color pcol50 = [0.702,0.698,0.278]
select surf_pocket50, protein and id [8812,8808,8809,8811,8398,8399,8401,8667,8624,8539,8672,8432,8540] 
set surface_color,  pcol50, surf_pocket50 
set_color pcol51 = [0.867,0.902,0.361]
select surf_pocket51, protein and id [17249,17252,16875,16876,18658,18664,17274,18644,18652,18645,18649] 
set surface_color,  pcol51, surf_pocket51 
set_color pcol52 = [0.643,0.702,0.278]
select surf_pocket52, protein and id [1866,1868,1455,1452,1594] 
set surface_color,  pcol52, surf_pocket52 
   
        
        deselect
        
        orient
        