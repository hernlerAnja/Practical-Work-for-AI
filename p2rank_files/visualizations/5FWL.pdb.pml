
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/5FWL.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/5FWL.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [10937,10938,12295,10999,11000,11001,11002,11037,10953,10998,11034,11670,11046,10774,10776,12288,12289,12265,12266,11959,11977,12222,11958,12019,11174,12024,12026,11089,12278,12252,12272,12018,11852,11866,12299,12301,11864,11869,13025,12497,12498,11728,11729,11727,12989,11703,11700,11717,11718,12570,12571,12572,11696,11715,11716,11856,11965,11966,11091,11968,12012,11175,11177,11935,12267,12268,11790,11791,11792,12209,10939,15757,15732,15733,12207,15698,15725] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.408,0.702]
select surf_pocket2, protein and id [1452,1453,1866,1867,1868,1872,1535,1565,1566,1456,1391,1865,1559,1829,1845,1558,2098,1466,1463,1464,1469,1328,1329,2097,1390,600,601,1889,1895,376,538,1888,5467,5500,1822,1823,1828,1852,602,553,599,1899,1901,1903,2625,597,609,610,598,646,691,689,634,1318,1327,1302,1345,1392,2170,2171,2172,2201,1626,1628,1612,1578,549,1805,1270,2589,1316,1317,777,1878] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.475,0.902]
select surf_pocket3, protein and id [26239,26162,26240,6377,6396,4685,26270,9091,9092,9094,7646,7648,7649,7644,7645,7647,6332,6330,6333,7598,19338,4683,4686,4688,19349,19350,7643,6376,6378,26235,26212,26199,26215,9107,26200,26250,26253,9104,9139,9172,9213,9103,9040,9055,9042,9135,8911,8912,9090,9171,4724,14955,25497,25498,6395,4722,6393,6394,5181,6392,4721,5182,5183,5184,5185,6329] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.329,0.702]
select surf_pocket4, protein and id [18083,17905,17314,17316,17907,17908,18164,18163,19161,19200,17351,17352,17862,17955,17919,17921,17923,17918,17926,19092,19127,19199,19124,19126,19109,19111,19125,26367,26327,26371,26372,26374,19489,19490,26387,26370,18115,18119,18120,18162,18147,18100] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.373,0.902]
select surf_pocket5, protein and id [26185,26220,9138,9140,9214,26181,9175,23459,24651,24652,24653,14869,14871,23493,23495,23496,14865,14863,14866,24591,24596,24541,24595,26184,26182,26145,26157,23458,23512,23513,23510,14940,14941,14872,14969,14970,23460,26084,26097,26186,26072,25461] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.310,0.278,0.702]
select surf_pocket6, protein and id [4737,4738,4739,4710,26322,26340,26303,20965,20986,20987,20988,27261,27293,27294,4657,27295,26355,26357,27222,27224,27223,4634,27190,20937,4635,27262,26342,16609,16611,20998,16622,16624,26351,20919,20920,20934,20935,4761,4760,20938,4658] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.451,0.361,0.902]
select surf_pocket7, protein and id [15416,15413,16563,16564,14914,14919,16624,15412,16627,15466,15411,14897,16508,16609,16611,26284,26289,26267,9119,26255,26264,4735,4737,4723,26306,26308,26268,26299,25538,25531,14949,14952,25524,14951,14987,14936,15467,15470,14988,25535,25536,4724] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.392,0.278,0.702]
select surf_pocket8, protein and id [7691,7692,7694,7748,7746,7724,7852,7673,7674,7677,7085,26197,26198,26154,26155,26156,26178,9276,8878,24648,8969,8930,7888,7884,7931,7932,7933,8861,7889,8896,8873,8893,9275] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.553,0.361,0.902]
select surf_pocket9, protein and id [6200,6199,6201,6612,6634,6181,6196,7572,6312,7569,7570,7571,6242,6243,6256,7619,6639,7555,7556,7515,7166,6661,6663,7168,6658] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.471,0.278,0.702]
select surf_pocket10, protein and id [4634,4686,4689,19347,19364,4657,27295,26357,27222,27223,26322,26303,26305,26286,26319,4739,4710,26307,19391,19394,19430,4635,4637,27237,26323,26325,19369,19371,26326,19428,19429,19490] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.655,0.361,0.902]
select surf_pocket11, protein and id [16622,16623,16626,16635,15412,16646,16651,16663,21054,16640,16662,16678,16639,16641,16046,15398,15399,15408,15432,16047,20998,15332,15378,15968,15969,15970,15395,15036,20841,15991,15994,20844,20830,15987,20840,21056,20865,20866,20867,20868,20869,25538] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.549,0.278,0.702]
select surf_pocket12, protein and id [14270,14337,15521,15522,15524,14336,14350,14362,14365,15071,14991,14992,15070,14872,14889,23572,23570,15056,14817,14780,14366,14841,14368,14819,14821,14822,14848,14852,14853,14854,14849,14862,14868,15480,14781,14870,24517,24515,24447] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.757,0.361,0.902]
select surf_pocket13, protein and id [16843,16865,16885,16889,16890,16892,16891,16893,16894,16995,16870,17781,17850,17746,17786,17787,16410,16412,16474,16425,16427,16429,16543,17802,16485,17800,17801,17803,16487,17397,17398,17399] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.627,0.278,0.702]
select surf_pocket14, protein and id [8999,9000,10013,10014,10015,19230,19231,7141,7142,7143,7144,20274,20275,10044,10039,10040,10043,19232,19233,17372,20208,20285,9974,20245,20246,20253,20270,20271,20281,20205,20332,17438,10101,20244] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.859,0.361,0.902]
select surf_pocket15, protein and id [4734,4720,4781,4783,5103,5105,25528,25529,4724,25497,25498,25521,25522,25523,25572,25573,25593,4721,4805,5104,5182,5183,5184,5185,5099,5101,4755,4776,4756,25543,25552,25542,25566] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.702,0.278,0.690]
select surf_pocket16, protein and id [17979,17942,26338,27488,27490,27344,27345,27431,27449,27475,26354,27189,26373,27138,27151,27152,21011,21021,16649,21073,21074,21075,27409,20988,27153,27332,27190,27187] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.902,0.361,0.839]
select surf_pocket17, protein and id [11077,13535,13536,13537,13538,11023,13522,13548,13549,13550,13551,13552,13523,15229,11024,12178,11078,12174,12202,12177,12186,12208,12207,11036,15205,15206,15207,15178] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.702,0.278,0.612]
select surf_pocket18, protein and id [5456,5487,5488,15771,5539,5540,10791,5455,5457,15687,15718,15719,15753,5470,10735,10749,15770,15768,5522,5523,5537] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.902,0.361,0.733]
select surf_pocket19, protein and id [676,677,731,732,1746,730,3149,3151,3152,4974,4975,4976,3137,3138,3135,3136,1809,623,624,1777,678,1778] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.702,0.278,0.533]
select surf_pocket20, protein and id [20035,20039,20041,20566,20505,20564,10349,19978,10288,10289,10293,10274,10275,20092,20443,20509,20508,20444,20506,20507,20504,20485,20486,20027,10213,10278,10277] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.902,0.361,0.631]
select surf_pocket21, protein and id [17492,17498,19023,20233,20224,10114,10115,20225,20226,20237,17476,18986,18987,10235,10113,10163,10175,17552,18976,17502] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.702,0.278,0.451]
select surf_pocket22, protein and id [24164,24830,24831,24872,24829,24230,24233,24633,24116,24118,24162,23440,23441,24177,24182] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.902,0.361,0.529]
select surf_pocket23, protein and id [15103,15104,15105,14315,14317,14320,14306,14248,14250,14305,14314,14353,14354,13410,13483,13484,13411,13413,13506,13939,13940,13505,15148] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.278,0.373]
select surf_pocket24, protein and id [24610,24611,24612,24305,24306,24810,24857,9238,9259,9240,24814,24812,9241,24234,24236] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.361,0.427]
select surf_pocket25, protein and id [16661,16662,16678,16677,16062,16064,16660,16663,21143,21144,21145,21147,21148,15993,15994,20844,20830,15989,16065,15990,22563] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.278,0.294]
select surf_pocket26, protein and id [10002,10003,10004,7130,7206,9993,7915,7917,7286,7287,7284,8938,8942,8948,10013,8839,8929,8949,8952,7118,8928,7205,7221,7260,7261] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.392,0.361]
select surf_pocket27, protein and id [17349,17492,17515,17517,18146,18147,18148,20235,20244,17436,17437,17435,19069,19173,17334,17491,19184,19185,19186,19159,19179,19169] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.345,0.278]
select surf_pocket28, protein and id [27207,26471,26473,26475,19470,19471,19472,26519,26521,26539,26468,26661,26662,27251,27221,27235,27245,27250] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.498,0.361]
select surf_pocket29, protein and id [5501,5502,1822,1823,1828,1855,5431,5434,5401,1832,5437,5435,4933,4951,5374,1808,1821,4950] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.427,0.278]
select surf_pocket30, protein and id [7120,7632,8930,7888,7932,7933,7889,7677,7085] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.600,0.361]
select surf_pocket31, protein and id [8987,9290,8986,9062,10026,9288,9324,9325,9326,9289,10023,10042] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.506,0.278]
select surf_pocket32, protein and id [4621,4622,4107,5292,5293,4108,4134,4549,4586,4550,4137,4135] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.702,0.361]
select surf_pocket33, protein and id [16504,16506,16516,16517,16452,16392,16393,15485,15429,15451,16522,16174,16175,16172,16808,16523,16520,16806] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.584,0.278]
select surf_pocket34, protein and id [6273,6274,6285,6286,6289,5199,6291,5254,5256,5941,5943,5944,6161,6162,6221,6220,6173,6175] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.804,0.361]
select surf_pocket35, protein and id [24517,24513,24514,24515,24509,24447,14841,14820,14821,14822,14862,14866,24541,24538,24470,24471] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.663,0.278]
select surf_pocket36, protein and id [25135,25136,5833,5834,5831,5762,5763,25754,25412] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.894,0.902,0.361]
select surf_pocket37, protein and id [5017,5031,405,441,3036,3037,3060,3035,3059,5525,3033] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.655,0.702,0.278]
select surf_pocket38, protein and id [25514,25575,25576,25577,25652,25653,26073,26059,26069,14965,26048,26045] 
set surface_color,  pcol38, surf_pocket38 
   
        
        deselect
        
        orient
        