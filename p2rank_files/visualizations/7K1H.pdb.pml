
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/7K1H.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/7K1H.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [7400,7397,7399,7208,7211,7212,7201,7202,7203,7205,7505,7507,7509,7510,7511,7417,7418,7728,7437,8277,8278,7401,8279,7648,7650,7744,7726,7246,7247,7248,7196,7821,7537,7565,7538,7541,7564,7630,8270,8271,8272,7644,7631,7743,8190,7796,7797,8161,8191,7789,7792,7818,7788,7725,7748,7760,7382,7383,7384,7197,7199,7200,7762,7765,7534,7535,7536,7567,7568,8300,8310,7532,7229,7230,8311,8315,7227,7566,8290,8273,8175] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.396,0.702]
select surf_pocket2, protein and id [3575,3577,3578,2706,3582,3583,3584,2704,3576,3101,3466,3467,3480,3102,2529,2512,2513,2516,2517,3605,2722,2723,2840,2814,2815,2816,2738,2935,3588,3594,3595,2870,2871,2872,2873,2812,2837,2810,2802,2803,2805,2809,3047,3048,2687,2688,3037,3043,3049,2689,2690,3053,3067,2504,2505,3070,2551,2552,2553,3495,3496,2501,2502,3094,3097,2692,2698,2702,2506,2507,2936,3071,3072,3093,3095,2955,3031,3033,2953,2949,2532,3603,2808,3065,3078] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.443,0.902]
select surf_pocket3, protein and id [695,696,1222,200,351,1230,349,602,336,149,151,198,199,156,159,160,163,164,352,1231,148,153,154,155,700,714,744,748,749,1113,1127,773,717,740,741,1143,1142,1223,725] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.290,0.702]
select surf_pocket4, protein and id [5476,5443,5444,5447,5451,5452,5421,5422,5845,5846,4851,4852,4859,4901,4902,5398,5925,5399,4903,5042,5048,5052,5380,5055,5932,5933,5934,5830,5926,5056,5816,4854,5037,5038,5039,5417,5403,5040,4855,5428,5420] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.412,0.361,0.902]
select surf_pocket5, protein and id [4884,5056,5956,5957,5927,5928,5938,4882,4885,5933,5093,5164,5160,5192,5187,5189,5190,5191,5221,5222,5153,5072,5381,5054,5055,5383,5305,5286,5925,5285,5299,5399,5303,5306,5384,5162,5193,5196,5220,5165] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.373,0.278,0.702]
select surf_pocket6, protein and id [12487,12491,12492,12856,12886,12966,12972,12973,12974,12965,12484,11894,11892,11941,11942,11943,12092,12095,12096,11895,11890,11891,11896,12516,12870,12443,12438,12885,12483,12457,12460,12468,12079,12455,12077,12078,12439,12345] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.545,0.361,0.902]
select surf_pocket7, protein and id [9544,9592,9729,9557,9593,9541,9540,9542,9591,10535,10616,10520,10141,10506,10536,10135,10137,10142,10134,10110,9545,10615,10622,10623,10624,10089,10088,10112,10111,10107] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.478,0.278,0.702]
select surf_pocket8, protein and id [602,517,600,603,518,519,1235,681,680,489,490,459,450,486,457,461,462,695,696,1222,1224,351,1225,1230,353,179,368,370,181,488,1246,1255,180,182,487,390,516,596,582] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.678,0.361,0.902]
select surf_pocket9, protein and id [10073,10618,10071,10074,9744,10615,10623,9572,10645,10646,9763,9746,9762,10617,9843,9877,9882,9574,9850,9852,9854,9855,9782,9880,9911,9912,10628,10641,10643,10644,9728,9742,9738,10070,9729,9593,10535,9993,9886,9995,9996,9975,9910,10089,10088,9976,10083,9883] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.580,0.278,0.702]
select surf_pocket10, protein and id [12000,12003,12006,12010,12009,12018,12026,12027,6933,6934,6935,6906,6936,6903,6971,11834,11782,11988,5546,5585,5587,5588,6884,6887,6897,6877,6880,5558,5486,5487,5523,5550,6868,5885,6902,5584,5586,5875,5874] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.816,0.361,0.902]
select surf_pocket11, protein and id [1574,11343,11344,11345,11376,11308,11309,11342,1288,1261,1266,1267,1269,1272,1280,1285,1286,1301,1287,1626,765,1114,11365,11364,1110,1115,1116,1117,1118,10410,11311,160,164,11363,1522,1582,1300,1571,1568,1284,1579] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.686,0.278,0.702]
select surf_pocket12, protein and id [4588,4589,4590,39,4591,66,245,260,263,266,267,270,4627,4626,281,273,90,91,3524,3236,3535,3234,3237,3238,3197,3199,3196,4557,4558,4561,4563,4542,4552,4523,4539,4532,4533,3525,275,283,3137,3173,4535,3208] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.902,0.361,0.851]
select surf_pocket13, protein and id [4987,12914,12915,12925,4976,4978,4963,4969,4970,12625,12627,12628,13928,13929,13931,13932,13933,12623,13924,4973,12590,12586,12592,12596,12599,12527,12526,12563,4794,4742,13976,14011,4948,14012] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.702,0.278,0.612]
select surf_pocket14, protein and id [11598,11628,11629,11631,10277,10278,11582,11630,7087,7293,11666,10565,7308,7314,7316,7319,7311,10275,10276,10574,10564,10236,10240,7331,10213,7323,7329,10249,10242,10176,10177,11579,11572,11575,11563] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.902,0.361,0.718]
select surf_pocket15, protein and id [9709,9714,9715,9716,9717,10106,11694,11696,11698,10120,10121,10102,10119,7364,7365,7371,7352,7372,10095,10098,10549,10551,9356,11688,7753,7776,7774,7775,9710,7369,9360,9359,9352,9362,9380,11716,9378] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.702,0.278,0.506]
select surf_pocket16, protein and id [784,820,2637,843,849,853,2619,2628,882,884,885,1171,783,1172,854,2184,856,2177,2203,2233,1182,2232,2268,2269,2610,2598,2444,2613,2616,2620,2392] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.902,0.361,0.584]
select surf_pocket17, protein and id [12445,6993,5019,5020,14033,7022,12448,5025,5026,5007,5027,14039,14042,14043,14045,14041,12064,12059,12060,12065,12066,12067,5412,5859,5024,5408,6999,7000,7001,7002,14061,5861,7003,5430,5431,12469,12470,12452,12471,12899] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.702,0.278,0.400]
select surf_pocket18, protein and id [12202,12261,12262,12423,12231,12263,12094,12096,12968,12972,12973,12965,12967,12984,12995,12996,11922,11924,11925,12113,12112,12200,12204,12205,12206,12145,12172,12343,12346,12232,12439,12345,12424,12339,12260,12325] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.902,0.361,0.451]
select surf_pocket19, protein and id [9330,9331,9677,9638,9653,9659,9668,9656,9660,9289,9291,9292,9293,9295,9432,9484,7891,7904,7865,7867,7895,7930,7831,7832,7931,7932,7933,8219,8230,8220,7866,9243,9246,9265] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.702,0.278,0.298]
select surf_pocket20, protein and id [709,316,4648,321,322,323,324,713,702,2676,2677,2296,727,2299,2300,2302,2669,2670,2298,705,4675,4676,728,726,317,4660,3080,3062,3079,4656,2675,2290,3058,3055,2674,2318,4674,3509] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.902,0.404,0.361]
select surf_pocket21, protein and id [9937,9939,9938,11734,9340,9341,9414,9305,9376,9377,11722,9374,9378,9345,11727,9381,11725,9943,9968,10601,9348,10097,9928,9984,9985,9982,9933,9936,9940] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.702,0.369,0.278]
select surf_pocket22, protein and id [2900,2942,2888,2896,2944,2945,2941,2898,2897,2899,2903,2928,3561,2938,4685,4687,2913,2914,2273,2275,2282,2283,2286,2243,2247,2279,2316,2319,2314,4679,4682,2285,3057] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.902,0.537,0.361]
select surf_pocket23, protein and id [6985,6986,6988,6989,12334,12335,12336,12278,7021,12283,12288,12447,7019,14067,14070,12290,6946,6947,6949,7017,14079,6944,6948,12331,12332,12323,12318,12328,12440,12444,12951,12293,12437] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.471,0.278]
select surf_pocket24, protein and id [2326,2327,535,540,545,547,550,704,4677,2324,1208,2328,575,22,591,592,593,589,4641,4644,4670,4674,2321,4673,4672,4632,4633,4640,4601,4602] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.675,0.361]
select surf_pocket25, protein and id [14025,14026,14028,14029,14016,14059,14062,13988,13989,5296,7024,14057,14058,7027,7032,5407,14018,5250,5253,5258,5263,7030,5911,5278,5288,5292,5294,5295,5238,5247,5248,5249] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.576,0.278]
select surf_pocket26, protein and id [7592,7593,7594,7598,9386,9389,9391,9395,9398,7583,7639,7640,7623,8256,7637,11712,11714,11717,11641,11681,11683,11684,7659,7752] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.808,0.361]
select surf_pocket27, protein and id [11879,11880,11884,11891,2352,988,1025,554,963,966,967,1994,1967] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.678,0.278]
select surf_pocket28, protein and id [4844,4839,4840,2907,2924,3319,3320,3321,3318,3316,3317,2913,2914,4351,4352,3340] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.859,0.902,0.361]
select surf_pocket29, protein and id [936,937,2024,2027,2028,910,2050,570,571,943,946,968,2348,2349,2344] 
set surface_color,  pcol29, surf_pocket29 
   
        
        deselect
        
        orient
        