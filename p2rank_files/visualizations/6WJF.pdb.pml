
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/6WJF.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/6WJF.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [4625,4626,4671,4672,4673,5257,5258,5311,5306,5307,5323,5222,4549,4550,4551,4552,4554,4557,4559,4553,5386,5692,5694,5549,5310,5546,5562,5542,3276,3277,3349,3352,5789,5792,5786,5787,5790,5793,5785,3351,3410,5815,5693,5814,5688,5690,5678,4724,4725,4739,4742,5198,5217,5183,3219,3199,5221,3228,3232,4689,4690,4692,4801,4804,4636,4637,4582,4579,4580,5400,5324,5382,5383,5096,5100,5111,5101,5330,4572,4577,5525,5526,5469,5384,5387,4691,4693,4695,5115,4654,4728,4727,3391,3392,3389,3331,5003,4820,4822,5000,5002,5021,5023,5001,5076,5058,5067,5073,5406,4335,5402,5421,4803,5004,5005] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.416,0.702]
select surf_pocket2, protein and id [12618,12564,12566,12739,12740,14031,12676,14174,14029,13944,13938,13942,14097,12455,12504,12505,12506,13546,13554,12459,13592,13151,13638,13111,13113,13114,12447,13555,13595,12798,12797,13932,12400,13150,13910,12446,12448,13164,12619,4399,14116,14117,14033,14187,12679,12543,12541,12544,13591,12540] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.498,0.902]
select surf_pocket3, protein and id [3745,3006,3007,1728,1729,1711,3741,3742,1730,1789,3740,1821,1822,1823,2069,3708,3709,3677,3758,3967,3970,3955,3954,2038,2922,2908,3791,3923,6288,6290,2958,6289,6291,6292,2961,3792,1714,2942,6302,6306,6333,18015,6305,3038,3040,6309,18039,18040,3056,6307,6283,6244,6249,1737,6335,1736,1748,1749,1750,1755,1760,11926,1758,1766,1767,1770,11927,11892,3707,3744,11891,4232,11923,11924,11888,11893,1771,1772,1774,2200,2195,2199,2293,2294,2296,2292,2362,4010,4012,4222,2344,4229,4230,11872,18041,11925,11933,11936,2254,11953,2176,2252,2251,2295,2297] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.357,0.702]
select surf_pocket4, protein and id [16071,16074,16075,16076,16077,16078,16079,16080,14478,14484,15653,14460,16193,15693,15695,15696,16192,15652,15648,16027,16028,16031,16033,14534,14535,14536,14676,14483,16154,14522,16238,14518,14523,16255,16073,16133,16188,14595,14596,14598,14529,16005,15012,15013,15014,15022,15025,16017,15029,15031,15026,15641,14675,14737,14385,14386,14430,15069,14315] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.416,0.902]
select surf_pocket5, protein and id [17092,17195,17197,17198,17199,17172,17194,17088,17746,18271,18666,18661,18577,17372,17252,18662,18660,17431,17029,17091,18184,18187,18194,18228,17137,17138,17139,18225,17080,17747,17784,17797,17033,17783,17079,17081,17087,17779,17794,18179,17176,9507,17174,17177,18749,18750,18268,18269,18658,18676,18677,18683,17173,9484] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.278,0.294,0.702]
select surf_pocket6, protein and id [11413,13406,13408,8156,8160,8846,8107,8110,11434,13382,6838,11435,6815,6816,6832,11437,11439,8206,8139,8142,9074,8844,8845,8862,9058,9071,8108,8109,8111,9057,9059,6876,6878,6879,6880,6925,6926,6927,8847,9072,7173,8013,8103,11375,8097,11393,8046,11395,8896,8895,7743,7142,8044,7742,8010,8012,8026,8039,13427,13405,8207,16473,16498,16503,16521,8849,16524,16525,16504,6841,6844,8813,6875,6877,16505,13383,16472] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.380,0.361,0.902]
select surf_pocket7, protein and id [9775,9776,9777,10491,10361,10409,10411,10414,10362,10415,10399,10403,10871,9832,9714,9663,10853,10855,9655,9661,9716,10626,10666,10667,10669,10646,10650,10851,10916,10792,8513,8453,8456,10796,10797,8380,10919,10917,10918,10782,8381,10485,10474,9653,9654,10477,10627,10630,10628] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.329,0.278,0.702]
select surf_pocket8, protein and id [14917,14918,14900,15627,15847,14901,14919,15843,15796,15962,15963,15048,15046,15047,15628,15192,15825,15191,15625,14817,14818,14897,14920,15989,15972,14990,15015,15050,15051,15052,15013,15014,15042,15049,15621,15639,15638,14993,15683,15663,15816,15812] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.463,0.361,0.902]
select surf_pocket9, protein and id [8437,8476,8478,8479,8480,8474,8475,8489,8549,7704,8436,8875,8877,9007,9043,8432,8435,8433,8452,8434,8453,8548,8122,8123,8125,8439,8441,8913,8915,11181,11170,11182,9006,9008,9831,8792,9756,9757,9758,8494,8496,9832,8831,8876,8808,8828,8830,8859,9775,8736,8738,8739,8190,9815,8135,8136,9814,9830,9817] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.388,0.278,0.702]
select surf_pocket10, protein and id [7173,7212,7213,7979,8013,9073,9100,9067,9068,9079,9083,9084,9099,9086,7516,7467,7980,9101,7513,7515,7172,7171,8011,8012,7594,7592,7595,7740,7756,7781,7725,7397,7398,7399,7461,7466,7304,11716,11715,16586,16587,7450,7448,7400,6871,6873,6874,7209,9115,9116,9114,6862,6863,7280,16555,16557,16559,16560,7358,7401,16582,16585,16558] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.541,0.361,0.902]
select surf_pocket11, protein and id [3066,3067,3068,3069,3070,3071,3204,6093,6095,3202,3002,2993,6269,6271,6272,6273,6274,6275,6131,6096,6129,6130,6126,6139,6086,6089,6090,6076,3056,3062,3151,3153,3152,3129,3130,6147,18095,18097,17897,6260,6145,18061,18062,3021,3335,3337,3904,3809,3810,3811,2992,3376,3902,6066,6078,6077,3870,3876,3878,3879,3871,3261,3263,3262,3264,3265] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.451,0.278,0.702]
select surf_pocket12, protein and id [2471,2523,2621,3593,2620,2536,2618,2524,3491,3492,3562,3984,3985,3983,3982,2636,2675,3591,3516,3594,2470,2472,3980,3981,4025,4026,3609,3626] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.620,0.361,0.902]
select surf_pocket13, protein and id [4512,4513,5563,5564,5565,5569,5570,5573,3534,5574,5575,14656,5586,5605,16135,14584,14595,4558,4553,4555,5694,5627,5639,5641,5650,5710,3409,5693,4480,4481,4483,5576,14655,4519,5524,5523,3611,4497,14583,4494,3536,3532,3533,3578,3581,4498,3531,3474,3457,4476,4523,4482,3613,4081] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.514,0.278,0.702]
select surf_pocket14, protein and id [3392,3376,3772,3901,3903,3385,3390,3372,3386,3370,3371,2603,3444,3445,3939,3019,3333,3773,3331,3461,4612,3688,4611,3634,3755,3515,4654,4728,4727,3704,3724,3726,3770,3330] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.698,0.361,0.902]
select surf_pocket15, protein and id [18198,18392,17907,18114,18201,18203,18398,18401,18429,17726,18214,18215,17757,17761,17763,18370,18372,17632,18115,17908,17946,18073,18074,17947,11779,11781,18243,18388,18365,18240,18255,18259,18342,18353,10002,17948,10003,9988,11774,11795] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.576,0.278,0.702]
select surf_pocket16, protein and id [7701,7723,7725,7668,7671,7724,7594,7592,7595,7740,8544,8548,8546,8599,8596,7639,7589,8594,8595,7702,7513,8713,8730,9082,9130,8620,8618,8697,7575,7576,7588,9083,9084,9085,7516] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.780,0.361,0.902]
select surf_pocket17, protein and id [13757,13758,13759,13765,13755,13720,13607,13709,4914,13608,13609,13678,13676,13622,13623,13626,13603,4882,4884,16407,4881,13480,13596,13274,13481,13482,13553,13567,13581,13582,13769,13737,13588,13739,13440,13315,13273,13275,16412,16414,13441] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.635,0.278,0.702]
select surf_pocket18, protein and id [10072,10074,10076,9355,9358,9410,9486,9482,9359,18307,18309,9308,9310,18287,9465,9309,9488,18290,18288,9411] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.859,0.361,0.902]
select surf_pocket19, protein and id [10307,10309,10325,10326,10287,10321,9828,9843,9845,9846,9776,10361,8303,8322,8381,8323,8331,8332,8336,8282] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.698,0.278,0.702]
select surf_pocket20, protein and id [4306,4307,4378,4251,11938,4201,4202,11939,4361,4203,4205,4252,4253,4254,13658,13652,13654,13655,13656,13675,13677,4380,4382,4420,4970,4971,4972,13610] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.902,0.361,0.863]
select surf_pocket21, protein and id [4241,3649,4220,4221,4230,4236,3647,3651,4463,4465,3654,4478,4479,4524,4461,4242,3612,4541,4364,4464,4206,4200,4203,4188,4239,4306,4218,4365] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.702,0.278,0.639]
select surf_pocket22, protein and id [14032,11974,14048,14049,14135,4416,4419,4420,14116,13653,13669,13635,13975,13658,13652,13654,4164,4205,11964,11970,11973,4165,4167,11961] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.902,0.361,0.784]
select surf_pocket23, protein and id [7464,7467,7980,7939,7834,7940,7523,7530,7524,7527,7528,7529,11710,11756,11757,7979,7781,7782,7833,11758,11713,11711] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.278,0.576]
select surf_pocket24, protein and id [1775,2065,2067,2873,3963,3964,3975,3950,3953,3954,2412,2637,2638,2677,3982,2636,2675,3984,2909,2468,2471,2536,2908] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.361,0.702]
select surf_pocket25, protein and id [6943,11517,6739,7193,7192,7194,6740,11555,11559,7957,7958,7959,7960,7961,7962,6675,6676,6701,6702,6671,6674,7154,7155,11533] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.278,0.518]
select surf_pocket26, protein and id [8753,9569,9322,9327,8752,8754,8755,9293,8757,8758,9629,9567,9562,9555,9294,9257,8717,9140,9141,9581,9386,9334,9324,9325,9333,8716,9289,9468] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.361,0.624]
select surf_pocket27, protein and id [2568,2570,3496,3498,5953,5955,1196,1197,1214,5957,3550,3549,3489,3494,5886,5887,3479,3481] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.278,0.455]
select surf_pocket28, protein and id [13794,13796,12976,13128,13894,12980,12981,12982,12947,12889,12890,12848,13795,12999,13565,13568,13131,13133,13127,13126] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.361,0.545]
select surf_pocket29, protein and id [10070,10073,10017,10018,9487,18289,18290,18291,18242,18236,18237,17176,18226,17138,18225,17155,17158,10074,9488] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.278,0.392]
select surf_pocket30, protein and id [14675,14737,14385,14386,14315,14316,14317,14318,14363,15975,15976,15068] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.361,0.467]
select surf_pocket31, protein and id [8232,13263,11366,13264,13226,13838,11247,11248,13837,8255,8257,8230,13228,13465,8174,11378,8172,11198,11200,11243] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.278,0.333]
select surf_pocket32, protein and id [8512,10745,10753,10810,8511,8581,8529,8582,8584,8462,8463,8514,8466,10795,10797,10793,10794,10811,10959,10755,10983,10989,10991,10957,10815,10816,8530,8531,10958] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.361,0.388]
select surf_pocket33, protein and id [2293,2292,2313,2362,2312,1774,2200,2199,2137,6608,6610,2363,2835,2109,2106,2108] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.290,0.278]
select surf_pocket34, protein and id [1195,1196,1197,1262,1259,2569,2570,2567,1312,1261,2546,2550,3550,3547,3548,3549,1213,3561,3562,3563] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.412,0.361]
select surf_pocket35, protein and id [9907,9924,9926,9793,9794,9908,9740,9799,9795,9797,10204,10180,10200,10205,9731,9741,10509,10105,10106,10108] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.353,0.278]
select surf_pocket36, protein and id [2892,2694,2708,1532,1601,2740,1552,1549,1523,1529,1508,1520,2705,2709,1597,2051,1585,1603,1604,2695,2696,2697,2712,2852] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.902,0.494,0.361]
select surf_pocket37, protein and id [4383,12537,4382,4384,12542,12543,13658,13591,13655,13656,4966,4912,4969,4971,13610,12522,12524,12505,13592,13594] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.702,0.412,0.278]
select surf_pocket38, protein and id [3038,3040,3041,6309,18039,18040,3052,3055,3104,3102,3103,18060,18037,17947,18074,18041,11834,11837] 
set surface_color,  pcol38, surf_pocket38 
set_color pcol39 = [0.902,0.573,0.361]
select surf_pocket39, protein and id [3937,3939,2597,2598,3983,3444,3442,3514,3492,2621] 
set surface_color,  pcol39, surf_pocket39 
set_color pcol40 = [0.702,0.475,0.278]
select surf_pocket40, protein and id [9891,9894,9895,16432,16429,16483,16464,16469,9818,16529,16488,8145,8208,8210] 
set surface_color,  pcol40, surf_pocket40 
set_color pcol41 = [0.902,0.651,0.361]
select surf_pocket41, protein and id [5883,5884,5886,5887,5651,3479,3481,5714,3496,1196] 
set surface_color,  pcol41, surf_pocket41 
set_color pcol42 = [0.702,0.537,0.278]
select surf_pocket42, protein and id [9662,10679,10690,8561,8638,8640,9600,9602,10707,10709,10798,8509,8512,10743,10745,8578,8511,8581,10731,8582] 
set surface_color,  pcol42, surf_pocket42 
set_color pcol43 = [0.902,0.729,0.361]
select surf_pocket43, protein and id [9144,7433,7434,7501,7451,7453,16622] 
set surface_color,  pcol43, surf_pocket43 
set_color pcol44 = [0.702,0.600,0.278]
select surf_pocket44, protein and id [3408,3359,3361,3362,3409,5813,5814,5811,5855,5854,5711,5810,5812,5707,5713,5935,5875,5876,5863,5853,5879,3426] 
set surface_color,  pcol44, surf_pocket44 
set_color pcol45 = [0.902,0.808,0.361]
select surf_pocket45, protein and id [1410,1412,2447,2470,2472,3594,4025,1325,2524,3593] 
set surface_color,  pcol45, surf_pocket45 
set_color pcol46 = [0.702,0.659,0.278]
select surf_pocket46, protein and id [9601,9602,10713,10714,8636,9204,9206,8635,8685,9599,9584,9587,9583] 
set surface_color,  pcol46, surf_pocket46 
set_color pcol47 = [0.902,0.890,0.361]
select surf_pocket47, protein and id [17764,17767,17613,17614,18527,18528,17615,17766,17523,18428,18425,17876,17580,17522,18459,18426] 
set surface_color,  pcol47, surf_pocket47 
set_color pcol48 = [0.678,0.702,0.278]
select surf_pocket48, protein and id [9617,9616,10629,10630,10571,10558,10573,10679,10680,9598,9600,9655,9656,9658] 
set surface_color,  pcol48, surf_pocket48 
set_color pcol49 = [0.831,0.902,0.361]
select surf_pocket49, protein and id [6702,6670,6671,6681,6701,7155,7844,7845,7847,7846,7957,7958,7959,7960,7961,7962,6676,7889] 
set surface_color,  pcol49, surf_pocket49 
   
        
        deselect
        
        orient
        