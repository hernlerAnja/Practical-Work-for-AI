
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/7PEC.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/7PEC.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [18447,18765,18774,18778,19157,18086,18089,18438,18088,18094,18439,18452,18457,18461,15727,15728,19533,18766,19144,19140,19141,19153,19525,19531,18217,15714,15712,15713,15723,15736,15739,19524,19151,19152,19166,19167,19168,19174,19185,17753,19851,17759,17762,19849,18462,18099,18104,18107,18466,18787,18465,18789,18788,18793,18485,18811,18812,18469,18503,18481,18484,17763,17766,17776,17777,17778,17779,18111,18110,19854,19859,19862,18442,18768,18753,15719,15722,18440,18441,15730] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.424,0.702]
select surf_pocket2, protein and id [27501,27523,27497,26072,27485,27493,27496,27824,28107,26070,27819,28103,26812,27143,26807,27142,28128,28125,28126,28129,28130,28131,27162,27521,27522,27844,27845,26792,26797,27132,27133,26441,26424,26071,26056,26060,28094,26416,26421,27128,27130,27490,27486,27474,27482,27483,27484,27808,26815,26445,26440,26442,26446,26076,26065,26073,26449,26110,28140,28141,26100,26098,26099,25822,26425,26481,26470,26471,26472,26474] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.514,0.902]
select surf_pocket3, protein and id [10471,10880,9663,9664,9665,10490,10877,10878,10879,9922,10117,9894,10497,10109,10114,10115,10116,10835,10867,10868,10870,9660,9661,9662,9703,9704,10520,10521,10872,10873,10903,10904,9943,10875,10146,10147,10148,10131,10132,10134,10136,10495,9945,10133] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.376,0.702]
select surf_pocket4, protein and id [10044,10050,10177,10013,10016,10179,30372,10154,10155,10153,10182,10185,10253,10211,10227,30753,30719,30745,30718,10181,10212,30343,30348,30361,30365,30351,30366,30369,30363,10157,10046,10045] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.451,0.902]
select surf_pocket5, protein and id [16240,16328,15419,16214,16333,16334,16336,16335,16223,16349,15402,14962,14963,14982,14768,14767,14781,14816,15360,16239,16325,16327,15271,15273,15355,15030,16329,16330,14990,15028,15029,15372,15378,15375,14946,15362,15371,15373,15356,15002,15370] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.278,0.325,0.702]
select surf_pocket6, protein and id [21914,21872,22734,6929,22733,22735,22708,22501,22500,22690,22498,22646,22647,22649,22656,22659,22651,7237,22535,22496,6930,6931,6933,22526,22528,6908,6932,21862,21863,21864,21898,6616,6939,6940,6941,6927,6928,6614,21896] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.361,0.388,0.902]
select surf_pocket7, protein and id [3124,3126,3127,3128,3398,3148,3074,3076,3397,3352,3154,3156,3297,3085,3079,3155,3431,3452,3256,3286,3296,3315,3316,3317,3318,3319,3320,3259,3081,3314,3312,3097] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.282,0.278,0.702]
select surf_pocket8, protein and id [25,135,196,198,200,224,226,24,262,42,45,119,117,120,375,339,102,105,338,344,60,323,44,134,133,5,234,374,348,345,22,40,99] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.396,0.361,0.902]
select surf_pocket9, protein and id [11057,9698,9700,10902,9948,11169,11157,11159,11164,11165,11158,10891,10897,10898,10901,11028,11029,10927,10928,10962,10963,10925,10926,9936,9950,9939,9941,10900,9983,11193,11192,9682,10871,10868,11138,11163,11161] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.333,0.278,0.702]
select surf_pocket10, protein and id [20302,20326,21001,20339,20384,20385,20346,20367,20368,20369,20487,20316,20323,20486,21015,21726,21002,21005,21666,21668,20999,21361,21365,21366,21662,21661,20997,21356,21359,20305,20416,21682,21683,20340,20412,21684,20413,20426,20419,20422,20495,20496,21724,21727,21673,21665,21658,20421,20324] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.459,0.361,0.902]
select surf_pocket11, protein and id [12122,12123,12605,12607,12608,12609,15156,12159,12160,12161,12162,12642,12192,12164,12167,16783,16754,16784,16786,16791,16792,12626,12630,15135,16767,16769,16761,15104,12126,12129,12130,12131,12132] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.380,0.278,0.702]
select surf_pocket12, protein and id [8953,8982,8985,8980,8981,8993,9020,9021,15873,15904,15905,15906,15876,15980,8955,8956,8702,8705,8992,8994,8700,8701,15908,15872,16575,16580,15871,15874,16567,16599,9023,15875,15898,15880,15881,15882,15883,8748,15983,16022,16024] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.522,0.361,0.902]
select surf_pocket13, protein and id [5388,5389,10559,10560,10265,10266,10267,1832,4750,5062,1831,1833,5418,10557,5084,5082,10593,10594,10556,4747,5351,5385,5387,10321,1856,1837,5027,5029,5367,5356,10296,10297,10298,10655] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.427,0.278,0.702]
select surf_pocket14, protein and id [26092,26117,26118,26484,26485,26491,26497,26473,26093,26501,26500,26131,26502,26637,26638,26639,26635,26477,25780,26628,26108,26496,26492,26649,26651,26626,26620,26641,26642,26644,26645,26648,25749,25747,25748] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.584,0.361,0.902]
select surf_pocket15, protein and id [17031,17032,17033,12288,28614,28615,28612,28611,16833,16834,16836,17057,17065,17092,17093,12285,12286,16832,16864,16865,16866,16867,16868,16869,16870,16835,12248,12246,12249,12278,12244,12245,12250,12689,12690,12730,12731,12280] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.478,0.278,0.702]
select surf_pocket16, protein and id [23893,23892,25569,24220,25529,25530,23923,23925,24205,23933,23931,23932,25540,25538,25570,23607] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.647,0.361,0.902]
select surf_pocket17, protein and id [13238,13241,13263,13264,13240,12981,15008,15009,12983,13325,16893,13326,12984,15299,15300,15039,15316,15011,15322,13262,13266,13267,13290,13291,12954,12987,15038] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.525,0.278,0.702]
select surf_pocket18, protein and id [29142,29261,29262,29263,29286,29181,28411,28414,29254,29134,29131,29133,29141,28437,28438,29143,29144,29145,29287,28431,28433,28941,28410] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.710,0.361,0.902]
select surf_pocket19, protein and id [23665,23687,25506,25507,25508,25481,25483,20114,20116,23954,23956,23984,24310,24007,23686,25479,25480,25482,24262,25509,23670] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.576,0.278,0.702]
select surf_pocket20, protein and id [29142,11268,29262,29263,29296,11484,11486,11487,29140,11488,11489,11492,29182,29183,29144,29145,11493,11494,11266,11269,11276,29197,29198,29236,29232,11516,11517,11265,11273,29237,11529] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.773,0.361,0.902]
select surf_pocket21, protein and id [14695,14859,14860,13552,14578,13233,15309,14597,15347,13231,13497,13520,14716,14718,14717] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.624,0.278,0.702]
select surf_pocket22, protein and id [22052,22054,22051,22144,20653,20654,21801,22143,20665,20668,20669,20670,22142,22114,22053,22055,22115,21803,21807,21810,21817,21819,21793,21795,21815,21790,21802,20657,20655,21785,21816,21818] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.835,0.361,0.902]
select surf_pocket23, protein and id [20810,21083,21084,21085,21105,21205,20963,21245,21219,21218,20283,20811,20979,20980,21341,21343,21429,21246,20962] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.675,0.278,0.702]
select surf_pocket24, protein and id [4264,4265,4266,3952,4233,3941,4209,4012,4013,4014,4330,4356,4357,4363,4360,3986,4388,4389,3984,4332] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.898,0.361,0.902]
select surf_pocket25, protein and id [22387,23461,23462,22360,22344,22358,22184,23172,23163,22210,22211,22212,22413,22441,22440,22407,22384,22386] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.278,0.678]
select surf_pocket26, protein and id [8051,8517,8511,8513,8090,8639,8486] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.361,0.839]
select surf_pocket27, protein and id [25474,25482,25451,25475,25448,24309,24618,24620,25440,25443,25444,24343,24974,24924,24945,24006,24342,24310,24007] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.278,0.631]
select surf_pocket28, protein and id [29080,28594,28596,28593,28595,28597,29090,29091,12329,12298,12330,11943,28624,28969,28982,28983,29010,28622,28642] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.361,0.776]
select surf_pocket29, protein and id [13969,14469,14470,14471,13992,13993,13970,13971,14417,14438,14474,14475,14472,20502,20508,20499,20500,20504,14428,14404,14439,14385,20539,14405,14382,14383,14381,20506,20510] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.278,0.580]
select surf_pocket30, protein and id [2356,2358,2500,2360,2332,2642,2672,2533,2670,2640,2641] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.361,0.714]
select surf_pocket31, protein and id [26104,28148,28150,26246,26247,25814,28151,28153,26124,26125,26256,28152,28172,28171,28154] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.278,0.533]
select surf_pocket32, protein and id [15567,15568,17438,17440,17394,17397,15566,15590,15591,15593,15437,16216,15434,15436,17402,17400,16210,17422,17452,16215,16200] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.361,0.651]
select surf_pocket33, protein and id [15748,17367,17365,15746,17369,16450,16448,15683,15685,15686,15691,15692,15703,15693,18076,18065,18064,18216,17368,17370,17372,16458,16459] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.278,0.482]
select surf_pocket34, protein and id [13232,15293,15298,15301,13227,13229,13237,15283,15039,13238,13241,14602,14599,14600,15294,15036,12956,13198,13205,13243,13207,12949,12947,12957,13242] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.361,0.588]
select surf_pocket35, protein and id [13566,13567,13563,13560,13588,13925,13640,13896,13897,13641,13607,13609,13570,13947,13923,13924,13592,15329] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.278,0.435]
select surf_pocket36, protein and id [26110,28139,28140,28141,26098,19986,19949,19947,19948,19956,19925,19926,25823,25821,25822,26478,26481,26474,27854] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.902,0.361,0.525]
select surf_pocket37, protein and id [8937,8938,8844,8846,8976,9092,9121,9123,8845,8847,8852,8876,8916,9146,9147,9115,8977] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.702,0.278,0.384]
select surf_pocket38, protein and id [24565,24566,24568,20040,20041,25495,20045,25496,24248,24219,24220,24221,24258,25501,25521,25524,25526,25528,25511,25520,25554,25555,20042,20079,25513,25556,25499,25502] 
set surface_color,  pcol38, surf_pocket38 
set_color pcol39 = [0.902,0.361,0.463]
select surf_pocket39, protein and id [18190,18192,18498,18165,18169,18171,18359,18168,18628,18629,18631,18262,18367,18369,18126,18127,18166] 
set surface_color,  pcol39, surf_pocket39 
set_color pcol40 = [0.702,0.278,0.337]
select surf_pocket40, protein and id [1289,1616,1267,1559,2027,1239,1241,2059,2022,2024,1583,2048,2083,2051,1667,1261,1592,1260,1558,1258,1259,1263,1264] 
set surface_color,  pcol40, surf_pocket40 
set_color pcol41 = [0.902,0.361,0.400]
select surf_pocket41, protein and id [10057,9861,9835,10058,30472,30555,30465,30468,30113,30124,30125] 
set surface_color,  pcol41, surf_pocket41 
set_color pcol42 = [0.702,0.278,0.286]
select surf_pocket42, protein and id [12201,12167,12029,12030,11854,11857,11858,11891,11853,12192,12191,12194,12195,12164,12166,11859,11860,12160,16786,12228,12229,11831,11827,11829] 
set surface_color,  pcol42, surf_pocket42 
set_color pcol43 = [0.902,0.380,0.361]
select surf_pocket43, protein and id [17510,19880,19691,19692,19882,19601,19603,19604,17623,17625,17626,17624,17494] 
set surface_color,  pcol43, surf_pocket43 
set_color pcol44 = [0.702,0.322,0.278]
select surf_pocket44, protein and id [4433,4434,4441,4442,4051,4052,4727,4726,4728,4410,4379,4381,4412,4700,1845,1838,1839] 
set surface_color,  pcol44, surf_pocket44 
set_color pcol45 = [0.902,0.443,0.361]
select surf_pocket45, protein and id [23320,23094,23095,23098,23078,23100,23318,23367,23364,23021,23022] 
set surface_color,  pcol45, surf_pocket45 
set_color pcol46 = [0.702,0.369,0.278]
select surf_pocket46, protein and id [12390,12279,12280,12738,12740,12306,12415,12277,12769,12770,12421,12444,12410,12416] 
set surface_color,  pcol46, surf_pocket46 
set_color pcol47 = [0.902,0.506,0.361]
select surf_pocket47, protein and id [24389,24732,24735,24712,24711,24422,24423,24725,24731,24397,24398,24399,24401,24402,24700] 
set surface_color,  pcol47, surf_pocket47 
set_color pcol48 = [0.702,0.420,0.278]
select surf_pocket48, protein and id [24343,24350,24644,24665,24975,24666,24996,25431,25447,24641,24639,24664,24973,24995,24997,24351] 
set surface_color,  pcol48, surf_pocket48 
set_color pcol49 = [0.902,0.569,0.361]
select surf_pocket49, protein and id [18960,18965,18966,18968,18824,18825,18977,18479,19012,19013,18478,18494,18971,18515,18516,18517,18979] 
set surface_color,  pcol49, surf_pocket49 
set_color pcol50 = [0.702,0.467,0.278]
select surf_pocket50, protein and id [22899,23217,22900,22901,22903,23216,22157,22128,22075,22088,22902,22904,22936,23200,23226,23227,22908] 
set surface_color,  pcol50, surf_pocket50 
set_color pcol51 = [0.902,0.631,0.361]
select surf_pocket51, protein and id [3156,3297,3155,3431,3452,3454,3484,3182,3296] 
set surface_color,  pcol51, surf_pocket51 
set_color pcol52 = [0.702,0.518,0.278]
select surf_pocket52, protein and id [14938,14936,15279,14602,14609,14924,15358,15359,14916,14918,14911,14921,15364,15360,15267] 
set surface_color,  pcol52, surf_pocket52 
set_color pcol53 = [0.902,0.694,0.361]
select surf_pocket53, protein and id [16023,16024,16589,16592,16027,9195,16028,16032,16639,9131] 
set surface_color,  pcol53, surf_pocket53 
set_color pcol54 = [0.702,0.565,0.278]
select surf_pocket54, protein and id [14326,14327,14328,14329,14330,14331,14300,14301,14302,13682,13714,13715,13681,13687,13688,14339,14340,14296,14297,14298,14299] 
set surface_color,  pcol54, surf_pocket54 
set_color pcol55 = [0.902,0.757,0.361]
select surf_pocket55, protein and id [28255,28233,28245,25990,25991,28235,28256,28251,28234,28060,28062,28064,28048,28055,28057,25964,28274,28043] 
set surface_color,  pcol55, surf_pocket55 
set_color pcol56 = [0.702,0.612,0.278]
select surf_pocket56, protein and id [30509,30315,30312,30314,30294,30810,30809] 
set surface_color,  pcol56, surf_pocket56 
set_color pcol57 = [0.902,0.820,0.361]
select surf_pocket57, protein and id [11466,11467,11468,11419,11453,11454,11152,11154,11389,11391,11240,11495,11237] 
set surface_color,  pcol57, surf_pocket57 
set_color pcol58 = [0.702,0.663,0.278]
select surf_pocket58, protein and id [25077,25076,25111,25113,25345,25171,25174,25344,25346,25369,25342,25370,25373,25365,25367] 
set surface_color,  pcol58, surf_pocket58 
set_color pcol59 = [0.902,0.882,0.361]
select surf_pocket59, protein and id [15622,15778,15680,17428] 
set surface_color,  pcol59, surf_pocket59 
set_color pcol60 = [0.690,0.702,0.278]
select surf_pocket60, protein and id [7924,7944,7948,8509,8021] 
set surface_color,  pcol60, surf_pocket60 
set_color pcol61 = [0.855,0.902,0.361]
select surf_pocket61, protein and id [13849,13853,13883,13885,14169,13857,14097,14100,14128] 
set surface_color,  pcol61, surf_pocket61 
set_color pcol62 = [0.639,0.702,0.278]
select surf_pocket62, protein and id [5431,5433,5434,10789,5429,5125,5422,5428,5436] 
set surface_color,  pcol62, surf_pocket62 
   
        
        deselect
        
        orient
        