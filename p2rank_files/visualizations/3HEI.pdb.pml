
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/3HEI.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/3HEI.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [10306,10308,12200,12203,12204,12207,12208,10381,10165,12222,12221,11751,12130,12109,12104,12198,12199,10380,10361,10362,10382,8413,8431,8433,10174,12175,12176,12177,12178,12179,10171,10172,10167,12138,15014,15016,15017,12140,10161,10360,10370,10284,10287,10288,10291,10402,10151,10159,10146,12187,12192,8412,8414,8411,10184,8405,10187,10190,10401,10282,11735,10265,11506,10214,12114,12116,14977,12131,12113,10324,14979,15002,15018,15022,15021,14973,15025,10344,10363,14549,14548] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.427,0.702]
select surf_pocket2, protein and id [14483,14484,14485,14486,14487,14525,14526,14156,14515,14516,15068,14157,14160,19557,19558,19527,14163,14166,19526,19528,19529,19567,19568,20110,19205,19198,19208,14148,20125,20127,14187,20129,15085,15083,19229,19230,19206,19207,14914,15087,19211,14913,14935,14937,19215] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.522,0.902]
select surf_pocket3, protein and id [2529,2530,3883,8132,8903,3652,3882,3863,3904,3905,8150,3650,3651,7571,8925,7572,8946,8905,8675,8690,8693,8694,8947,3633,3634,3648,3090,3107,3108] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.384,0.702]
select surf_pocket4, protein and id [5264,5265,5266,5339,7161,7162,7165,7179,7180,7164,7166,5340,7145,5245,5246,5249,6464,7158,7064,7157,7150,7155,7156,5172,13454,13455,5119,5123,5125,5128,5129,7096,7098,7136,7137,5132,5142,5148,13445,13447,13456,7135,13475,13476,7139,7140,5359,5360,5223,5235,5242,5173,5318,5319,5320,5338,5117] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.467,0.902]
select surf_pocket5, protein and id [2046,2054,2113,276,279,278,277,238,240,2025,2018,2028,17494,17546,17542,17535,17537,17538,2056,271,17069,17539,2047,17523,17530,17498,260,17500,17543,2032,77,298,2094,286,223,297,2021,2022,2095,2114,2115,2116,2119,67,72,74,75,87,90,62] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.278,0.341,0.702]
select surf_pocket6, protein and id [18001,18005,18014,17993,17991,17992,19842,17983,19835,17974,17980,19819,19823,19802,17844,17846,19803,19276,17845,17824,17811,17812,17813,17816,17817,17821,17814,19272,19824,19277,19278,19279,19280,19844,19828,18006,19048,19838,19839] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.361,0.412,0.902]
select surf_pocket7, protein and id [5859,5505,5507,5862,6242,6243,5848,5851,5853,5855,5842,5498,13422,13425,13418,5520,13083,13068,13070,13414,13411,13806,13405,13082,5491,5510,5516,5069,5519,12702,13061,13057,12643,13079,13073,12649,12631,12632,12637,12638,12639,12645,12625,12627,13077,12636,12648,5858] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.278,0.298,0.702]
select surf_pocket8, protein and id [6667,6675,6672,6673,6674,7219,7214,5206,5208,7198,5211,5241,5382,5389,5377,5378,5379,5388,5375,5386,7218,7233,5401,7237,7239,7230,7223,5396,5400,5383,5387,5216,5365] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.365,0.361,0.902]
select surf_pocket9, protein and id [10558,10561,10556,8028,8026,8379,8380,10536,10552,10540,8383,8040,8019,8031,8037,7590,8015,10549,11285,10884,7596,7601,7606,10893,7636,10901,10904,10547,10541,10890,10897,7661,10895,7583,8363,8762,8763,8764,10127,10110,10111,10116,10117,10122,10124,8369,8372,8374,8376,10157,10182,10150,10153,10154,10128,10152] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.302,0.278,0.702]
select surf_pocket10, protein and id [7737,7732,7907,7908,7909,9735,9739,9754,9195,9751,9740,7740,7762,9719,7890,7896,7904,7910,7917,7903,7899,7916,7922,9758,9760,9744,9193,9194,9196,9188,7727,7733,7736] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.420,0.361,0.902]
select surf_pocket11, protein and id [7686,7684,8399,8401,8404,8406,10201,10205,10206,10519,7665,7680,10918,10921,10922,10927,10919,10920,7997,7998,8004,8009,8016,8008,7993,7667,10904,10903,10537,10186,10529,10188,8398,8400,8382,8397,8383,10530,10533] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.345,0.278,0.702]
select surf_pocket12, protein and id [7786,9679,9682,9683,9686,9687,10955,9654,9657,9656,9660,9677,9658,9661,9666,9671,7763,7766,7767,7770,7785,7787,9700,9701,9676,9678,7663,7669,10926,10924,10935,10954,7880,7881,7860,7649,7640,7644,7646,7650,7653,7859,7861,9619,7666,7694] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.475,0.361,0.902]
select surf_pocket13, protein and id [163,164,166,167,174,177,2156,347,327,336,340,344,346,345,359,358,1630,1631,1633,169,170,2195,2197,2188,2181,2182,1625,1632,2191,2172,2176,323,197,198,199,2155] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.388,0.278,0.702]
select surf_pocket14, protein and id [17722,17923,17924,17925,17926,17709,17712,17713,17714,4942,4932,4933,4934,4938,4937,19703,19761,19762,4930,19693,19694,19666,19667,19669,19672,17887,19676,19677,4464,4465,17935,17928,17854,17724,17727,17728,17941,17943,17944,17945,17734,17721,17737,17870,17871,19766,19767,19741,19742,19770,4889,4940,4941,19679] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.525,0.361,0.902]
select surf_pocket15, protein and id [10411,10420,10261,10424,10430,10283,12239,11714,11715,11716,11717,12240,11709,10438,10442,10443,10248,10250,10251,10258,10253,10429,12256,12260,12272,12275,12265,12279,12281,10407] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.431,0.278,0.702]
select surf_pocket16, protein and id [4697,2720,4676,4677,4151,4152,4153,4154,2844,2866,2685,2698,4716,4718,2868,2875,2861,2865,2867,2879,2880,2888,2848,2854,2857,2858,4703,4698,4702,4709,4146,4693,4712] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.580,0.361,0.902]
select surf_pocket17, protein and id [17054,1340,17055,587,17070,585,1325,1326,47,63,1317,1318,1316,286,284,291,247,248,1098,256,17066,17068,17074,17081,270,271,17069,244] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.475,0.278,0.702]
select surf_pocket18, protein and id [10144,10147,11400,11409,11410,11401,11403,10671,11182,10360,10365,10368,10370,10372,10375,10371,10131,10145,10146,10148,10149,14534,10654,14531,14544,14545,14546,14547,14548,14553,14560,14533,10328,10356,10331,10332,14530] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.635,0.361,0.902]
select surf_pocket19, protein and id [5912,14729,14728,5892,5893,12686,12902,12688,12692,12685,5884,5887,5890,5891,12705,12808,12812,12805,12809,12922,12923,12903,14627,14719,14720,12901,14708,14721,14724,14725,14726,14727,12827,12828,12829,14742,14743,12682,14698,14696,14697,14699,14700,14661,12693,12695,14659] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.518,0.278,0.702]
select surf_pocket20, protein and id [17917,17933,18963,17707,17710,4462,4464,4450,4446,4447,17891,17892,17935,17931,17923,17709,18964,17895,18966,17893,17894,18230,18745,18232,18972,18973,18233,18234,18987,4449,18760,17938,4474,17903,4469,17919,4461,4476] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.690,0.361,0.902]
select surf_pocket21, protein and id [12768,12804,12772,12779,12782,12928,12820,14761,14777,14781,12971,12941,12963,12945,12949,12951,12952,12959,12967,12972,12938,12940,12950,14237,14786,14796,14782,12803,14230,14235,14236,14238,12769,12775] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.561,0.278,0.702]
select surf_pocket22, protein and id [19228,19229,19230,19207,14914,15087,20127,14188,20129,19227,14203,14205,14206,15110,15118,15099,15100,15101,14896,14898,15105,14197,14201,19232,19239,19208] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.745,0.361,0.902]
select surf_pocket23, protein and id [5879,12707,5165,5876,5877,5878,5885,13051,13424,13439,13040,13440,13441,13448,12722,12726,5163,5495,5488,5491,5493,5477,5861,5862,13425] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.600,0.278,0.702]
select surf_pocket24, protein and id [15466,15469,15493,15470,15472,15462,15484,15485,15487,17307,17308,17314,17323,17317,17282,16758,16759,16751,17303,17298,15325,17302] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.800,0.361,0.902]
select surf_pocket25, protein and id [2240,2243,2246,231,2007,2147,2136,306,212,219,232,214,324,325,2175,2203,2204,2151] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.643,0.278,0.702]
select surf_pocket26, protein and id [14140,14141,14142,14152,14168,14169,19519,19898,19507,19518,19926,19927,19947,19902,19945,19951,19965,19967,19963,19954,14110,14117] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.855,0.361,0.902]
select surf_pocket27, protein and id [2733,2734,2735,4790,4668,4669,4672,2740,2737,4725,4696,4767,2752,2753,2827,4761,4657,2736,2846,4529,4764] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.686,0.278,0.702]
select surf_pocket28, protein and id [17369,17372,17373,17366,15339,15340,17277,17301,15338,15358,15342,15345,17273,17132,17133,17134,17262,17274,17330] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.361,0.890]
select surf_pocket29, protein and id [9767,9780,9803,9806,7869,9738,9714,9809,7777,7782,9570,9571,9710,7772,7775,7779,9699,7794,7795] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.278,0.671]
select surf_pocket30, protein and id [19822,19893,19798,17862,19794,17859,19851,19654,19655,17866,17878,17879,19887,19890] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.361,0.835]
select surf_pocket31, protein and id [7259,7217,7283,7285,7288,7246,7282,5273,7276,5261,5274,5258,5255,5257,5348,5251,5254,7189,7178,7182,7050,5256,7190,7193] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.278,0.627]
select surf_pocket32, protein and id [14808,14809,14851,12837,14845,14752,14753,14756,12818,12819,14780,14741,12821,12824,14613,12817,14822,12911] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.361,0.780]
select surf_pocket33, protein and id [10296,10300,10297,10298,10408,10409,12296,12295,10315,10316,10390,12301,12330,12259,12288,12324,12327,12220,12231,12235,12092,10303] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.278,0.584]
select surf_pocket34, protein and id [20155,20157,20159,20160,20163,14036,14031,14034,20152,14185,14190,14193,14195,14197,14122,19938,20164,20166,14179,14180,14043] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.361,0.725]
select surf_pocket35, protein and id [13414,13806,13405,5498,13422,13418,13068,13070,5140,5115,13416,5490,5489,5491,5494,5069,5075,5515,5080,5082,5085] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.278,0.541]
select surf_pocket36, protein and id [10982,10992,10950,10980,10979,10931,10937,10947,10952,11307,11309,10865,10517,10994,10910,10879,10912,10914,10869] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.902,0.361,0.671]
select surf_pocket37, protein and id [3106,3108,3847,2568,2584,8952,8957,8961,8962,7564,7569,2567,8954,3861] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.702,0.278,0.502]
select surf_pocket38, protein and id [13433,13452,13435,13436,13830,13832,13451,13453,13468,13473,13501,13503,13504,13471,13038,13463,13458,13513,13390,13386] 
set surface_color,  pcol38, surf_pocket38 
set_color pcol39 = [0.902,0.361,0.616]
select surf_pocket39, protein and id [11733,10282,11735,11736,11505,11506,11504,12222,12221,10287,10288] 
set surface_color,  pcol39, surf_pocket39 
set_color pcol40 = [0.702,0.278,0.459]
select surf_pocket40, protein and id [2373,2391,2393,1781,2406,2429,2422,2433,2434,2426,2436,1817,2359,2452,1796,1797,1486,1487,1798] 
set surface_color,  pcol40, surf_pocket40 
set_color pcol41 = [0.902,0.361,0.561]
select surf_pocket41, protein and id [8952,8962,2797,2807,2805,2802,2809,2815,3840,2583,2584,2812,3837,3838] 
set surface_color,  pcol41, surf_pocket41 
set_color pcol42 = [0.702,0.278,0.416]
select surf_pocket42, protein and id [19619,4913,19474,19475,19646,4900,19621,19678,19679,19680,17907,19620,4914,19622,17910,17905,19493,19494,19597,20011,19645,17887] 
set surface_color,  pcol42, surf_pocket42 
set_color pcol43 = [0.902,0.361,0.506]
select surf_pocket43, protein and id [19246,19248,20158,20159,14017,14038,14200,14246,14204,15115,14219,14220,14221,14218,19264,19242] 
set surface_color,  pcol43, surf_pocket43 
set_color pcol44 = [0.702,0.278,0.373]
select surf_pocket44, protein and id [7610,7624,7626,7627,8889,7628,7631,3910,3911,2522,2527,2530,8133,8149,8903,3906,8150] 
set surface_color,  pcol44, surf_pocket44 
set_color pcol45 = [0.902,0.361,0.451]
select surf_pocket45, protein and id [8410,8788,8429,8426,8471,8416,8344,7998,8348,8358,8359,8459,8393,8461,8391] 
set surface_color,  pcol45, surf_pocket45 
set_color pcol46 = [0.702,0.278,0.329]
select surf_pocket46, protein and id [18694,18680,18681,18682,18683,18657,18659,19832,19926,19927,19843,19906,19903,18268,18315,18316,18296] 
set surface_color,  pcol46, surf_pocket46 
set_color pcol47 = [0.902,0.361,0.396]
select surf_pocket47, protein and id [15921,15954,15956,16351,16349,15989,15973,15992,16022,16024,16034,15907,15911,15993,16036] 
set surface_color,  pcol47, surf_pocket47 
set_color pcol48 = [0.702,0.278,0.286]
select surf_pocket48, protein and id [16160,16161,17385,16159,16173,16174,17311,17322,17405,17406,15747,15775,16162,16136,16138,16139,15794,15795,17382,16140] 
set surface_color,  pcol48, surf_pocket48 
set_color pcol49 = [0.902,0.376,0.361]
select surf_pocket49, protein and id [7763,7766,7767,8985,9700,9701,8983,8984,7761,9215,8964] 
set surface_color,  pcol49, surf_pocket49 
set_color pcol50 = [0.702,0.314,0.278]
select surf_pocket50, protein and id [7227,7300,7298,7299,7301,7238,5663,6076,6078,6056,6054,6055,6075,6089,5691,6077,5710,5711,7321,7322] 
set surface_color,  pcol50, surf_pocket50 
set_color pcol51 = [0.902,0.431,0.361]
select surf_pocket51, protein and id [5180,5182,5912,14729,5919,5920,5183,5921,5922,5897,5913,5914] 
set surface_color,  pcol51, surf_pocket51 
set_color pcol52 = [0.702,0.357,0.278]
select surf_pocket52, protein and id [19069,19770,19771,17850,19784,17871,19766,19785,17854,17728,17944] 
set surface_color,  pcol52, surf_pocket52 
set_color pcol53 = [0.902,0.486,0.361]
select surf_pocket53, protein and id [5723,5725,5726,5728,5729,5719,5677,5687,5678,5740,15819,15483,15494,15820,15495,15814,15813] 
set surface_color,  pcol53, surf_pocket53 
set_color pcol54 = [0.702,0.400,0.278]
select surf_pocket54, protein and id [3908,3920,7839,7847,7849,3909,8879,7623,7625,7626,7844,7851,7854] 
set surface_color,  pcol54, surf_pocket54 
set_color pcol55 = [0.902,0.541,0.361]
select surf_pocket55, protein and id [17709,17712,4942,4937,4952,4464,4446,4889,4939,4940,4941,4953,4455,4962,4966] 
set surface_color,  pcol55, surf_pocket55 
set_color pcol56 = [0.702,0.443,0.278]
select surf_pocket56, protein and id [5329,6358,6359,5289,5105,6140,5290,5627,6367,5333,5326,5328] 
set surface_color,  pcol56, surf_pocket56 
set_color pcol57 = [0.902,0.596,0.361]
select surf_pocket57, protein and id [2743,2744,2745,4640,4658,4659,4644,2818,2602,2728,2724] 
set surface_color,  pcol57, surf_pocket57 
set_color pcol58 = [0.702,0.486,0.278]
select surf_pocket58, protein and id [10015,9049,9050,9360,10016,9985,9991,9992,9996,9936,9937,9977,9969,9964,9382,9380] 
set surface_color,  pcol58, surf_pocket58 
set_color pcol59 = [0.902,0.651,0.361]
select surf_pocket59, protein and id [8232,9748,8231,8184,8212,8599,8575,8577,8596,8610,8597,9822] 
set surface_color,  pcol59, surf_pocket59 
set_color pcol60 = [0.702,0.529,0.278]
select surf_pocket60, protein and id [10733,11096,12280,10752,10753,12343,11117,11118,11119,11120,10705,11131] 
set surface_color,  pcol60, surf_pocket60 
set_color pcol61 = [0.902,0.706,0.361]
select surf_pocket61, protein and id [18216,19008,17655,17656,19009,18988,18989,18777,18778,19031,18776] 
set surface_color,  pcol61, surf_pocket61 
set_color pcol62 = [0.702,0.573,0.278]
select surf_pocket62, protein and id [4780,3142,3189,4715,4717,3555,3556,3557,3170,3533,3534,3535,4777,3554,4801,4800] 
set surface_color,  pcol62, surf_pocket62 
set_color pcol63 = [0.902,0.761,0.361]
select surf_pocket63, protein and id [898,863,825,847,828,1225,896,866,908,853,1227,433] 
set surface_color,  pcol63, surf_pocket63 
set_color pcol64 = [0.702,0.612,0.278]
select surf_pocket64, protein and id [12893,12896,12889,12891,12892,13921,13930,13922,12668,13924] 
set surface_color,  pcol64, surf_pocket64 
set_color pcol65 = [0.902,0.816,0.361]
select surf_pocket65, protein and id [11930,12056,12057,12058,12083,12082,12114,12115,12116,12117,14984,10347,11912,14997,14998,11931] 
set surface_color,  pcol65, surf_pocket65 
set_color pcol66 = [0.702,0.655,0.278]
select surf_pocket66, protein and id [3744,3429,3417,3419,3384,3746,3349,3368,3748,3374,3351,2954,2956] 
set surface_color,  pcol66, surf_pocket66 
set_color pcol67 = [0.902,0.871,0.361]
select surf_pocket67, protein and id [5950,5889,5895,5900,5867,5870,6267,5475,5477,6269,5908,5940,5905,5872] 
set surface_color,  pcol67, surf_pocket67 
set_color pcol68 = [0.702,0.698,0.278]
select surf_pocket68, protein and id [17532,2043,2065,1808,2064,17533,2049,1807,16901,16902,17525,16905,17527,17524,17526,17528] 
set surface_color,  pcol68, surf_pocket68 
set_color pcol69 = [0.875,0.902,0.361]
select surf_pocket69, protein and id [16943,16945,17527,17524,17578,17579,16612,16613,17532,17499,17500,17501,17561,17559,17554] 
set surface_color,  pcol69, surf_pocket69 
set_color pcol70 = [0.659,0.702,0.278]
select surf_pocket70, protein and id [18082,18555,18870,18872,18874,18428,18545,18472,18475,18494,18500] 
set surface_color,  pcol70, surf_pocket70 
set_color pcol71 = [0.820,0.902,0.361]
select surf_pocket71, protein and id [10372,10376,10378,10375,10144,10162,10158,10159,10146,10135] 
set surface_color,  pcol71, surf_pocket71 
   
        
        deselect
        
        orient
        