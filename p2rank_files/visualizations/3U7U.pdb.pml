
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/3U7U.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/3U7U.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [19901,19963,24519,24525,24526,24508,24512,24517,24521,19865,19964,24503,24504,24502,19886,19891,19892,19896,19905,19872,19887,24481,20113,19909,19921,19924,19904,20092,20098,20103,19903,24537,24719,24729,24714,24540,24520,24599,24704,24708,24712,19910,19911,19912,19913,24578,24579,24583,24584,24588,19805,24580,19798,19786,19983,24529,24528,24527,19968,19972,24414,24421,24402,24409,20088] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.420,0.702]
select surf_pocket2, protein and id [21186,21389,21405,21409,29451,21407,29452,29450,18365,29405,29407,29449,29404,29406,20915,21203,20900,21187,20916,18507,18508,18519,29475,29456,29477,29470,29466,21404,21411,21416,21408,18610,18342,18344,18349,18366,18452,18451,18515,18517,18518,18482,18478,18480,18481,18402,18338,18357,18354,29408,20746,20749,20752,20753,20755,20695,20701,20703,20934,20751] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.506,0.902]
select surf_pocket3, protein and id [10577,10581,10582,10583,10573,10575,10564,10568,10635,15217,15219,10558,10537,10559,15280,10636,15181,15188,15279,15202,15203,10785,10593,10775,10576,10648,10640,10644,15121,15102,10760,10653,10655,10768,10585,10470,10477,15288,15284,15299,10458,15414,15419,15220,15225,15228,15229,15237,15227,15212,15221,15222,15208,15122,15114,15118,15408,15292,15404,10465] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.365,0.702]
select surf_pocket4, protein and id [5891,5892,5893,1596,1598,5901,5904,6083,1581,1658,1586,1587,1590,1591,1582,1488,1481,5881,1493,1497,1500,5883,5884,6078,5961,5962,5963,6072,6075,6076,1600,1604,1607,1608,1606,1798,6092,1678,1783,1787,1599,1616,1808,1793,1807,5866,5867,5868,5871,5872,5876,5885,5773,5766,5778,5782,5785,5890,5886,5889,1560,1659,5845,5944,5942,5943,5947,5948,5956,5952] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.431,0.902]
select surf_pocket5, protein and id [10710,10702,11001,11000,10697,10675,10689,10693,10762,10698,10997,10994,15500,15501,15528,15527,15502,9631,9632,9633,9431,9432,9433,9446,9447,9429,15510,9252,9646,11008,11010,11012,10730,8980,10674,10733,10659,8972,8975,9236,9237,10680,8993,9251,10751] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.278,0.310,0.702]
select surf_pocket6, protein and id [451,462,1703,1712,265,266,461,22,280,281,2035,2020,2023,2024,2031,2033,6192,1721,1756,1749,1753,1,2,6165,6166,6164,6174,1720,1733,1715,1713,1716,1719,660,661,662,475,476,675,1698,1785,1697,1682,1774] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.361,0.361,0.902]
select surf_pocket7, protein and id [9011,9004,9008,9015,9181,9184,9185,12088,9031,9032,9183,28659,28660,28661,28658,12077,12079,12080,12081,28665,9276,9014,9019,9016,28617,9020,9021,9022,9023,11427,12087,9173,9174,28684,28686,28681,9068,28615,9067,28614,28679,28680,28584,9148,9153,9146,9104,9144,9147,9106,9118,9117,12083,11858,11859,12066,12072,11588] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.310,0.278,0.702]
select surf_pocket8, protein and id [20021,20025,20026,20061,20328,20329,20338,20340,20058,20090,20020,18571,18766,18767,18570,20339,18307,18311,18314,18306,18756,20007,20016,20017,20002,20008,19986,19987,20079,20325,20322,24828,18585,18586,18780,18327,20024,20038,18965,18966,18967,24801,24800,24810,18781] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.431,0.361,0.902]
select surf_pocket9, protein and id [4747,6006,5988,4286,4287,6041,6318,6320,4565,4566,4549,4551,4307,4550,4306,5982,6059,4947,5997,6001,6005,6070,6000,4945,1889,4746,4946,4760,4761,6010,4960,6018,6309,6308,6038,1881,6316,1879,1880,6292,6302,6305,6057,1907] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.365,0.278,0.702]
select surf_pocket10, protein and id [15684,15614,15615,15616,15688,15894,15742,15743,15892,15893,15911,15686,15691,15755,19729,19620,19630,15708,19617,19631,19632,19633,15685,19761,15595,15596,19444,19445,19446,15458,19423,19754,19421,19422,15673,19753,15563,15568] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.506,0.361,0.902]
select surf_pocket11, protein and id [10111,10088,25192,25193,25194,10110,10112,10302,10303,10304,10292,10289,25008,25010,25042,25043,25211,24973,10089,24980,24984,24985,24988,24991,24987,10401,10426,10433,10087,24895,24896,24914,24915,24916,24992,24758,25055] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.420,0.278,0.702]
select surf_pocket12, protein and id [24247,24345,24036,24037,24038,24039,24248,2273,2271,24233,24236,24370,24377,2052,2059,2063,2064,2066,2070,2081,2087,24060,24371,2067,2121,2134,2071,2272,2122,1993,1995,24062,1994,1837,2290,24061] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.576,0.361,0.902]
select surf_pocket13, protein and id [23582,23583,24944,24945,23382,23396,23397,23379,23383,24637,24641,24642,24634,24706,24954,24956,23186,23187,23201,22943,24674,24677,24695,24633,24618,24624,23367,23368,24619,24603,20184,24938,20212,23202,24952,23581,20183,20185,20186,20194] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.475,0.278,0.702]
select surf_pocket14, protein and id [14082,14083,14281,14282,14283,13902,14096,14097,15354,15337,15340,15341,15342,15406,15318,15323,15324,15333,15336,15644,15641,15645,10857,10856,10884,14296,10858,10866,13887,13886,15652,15654,15656,13643,13901,15374,15377,15395] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.647,0.361,0.902]
select surf_pocket15, protein and id [16502,16503,16216,16231,16232,16723,29060,16067,13672,13673,29059,29058,16705,13670,13681,29016,29012,29013,29014,29015,13665,13658,13660,16011,16071,14305,16019,16062,16065,16068,13674,16014,16017,16732,29083,29085,29064,29074,13654,16716,16721,16724,16725,16710,13834,13835,13823,13824] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.533,0.278,0.702]
select surf_pocket16, protein and id [20368,20372,5402,5403,20298,20300,20427,20577,20576,20578,5400,5425,5426,20376,20375,20575,20553,5401,5399,5612,20369,5709,20392,5597,5600,20245,20247,20299,20426,20439,20595,20280,20252,20140,20142,20357,5733,5734] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.722,0.361,0.902]
select surf_pocket17, protein and id [27890,27895,27823,27874,27867,37,213,214,3111,3102,3103,3104,203,44,210,212,173,175,146,147,176,177,27888,27822,27824,27889,27793,97,142,27893,60,27870,43,45,61,49,306,305] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.588,0.278,0.702]
select surf_pocket18, protein and id [29842,29843,29844,29845,29800,29801,29795,26005,25803,25516,25530,25532,25531,26020,26021,26023,26024,26025,25819,29849,29798,25802,26010,26016,26032,26031,22954,29865,29870,29868,22958,22960,22961,22966,22965,22981,29797,23124,23134,23135,22973,22970,25371,25367,25311] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.792,0.361,0.902]
select surf_pocket19, protein and id [23096,23124,23131,23133,23134,23135,23094,23097,23018,23056,29768,29863,22965,22981,22982,29797,29799,23226,23067,23068,22960,22964,22966,23098,23103,29798,29859,29864,29842,29843,29844,29800,29801,29795,22970] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.643,0.278,0.702]
select surf_pocket20, protein and id [4495,4488,4497,4499,4330,4345,28225,4324,4329,4346,28221,28223,28224,28222,28287,28288,28268,4322,4328,4456,4457,4460,4382,4418,4423,4461,4462,4590,4431,4432,4420,28192,7389] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.863,0.361,0.902]
select surf_pocket21, protein and id [2398,2404,2390,2396,2397,2441,2611,45,49,51,52,53,27826,2450,27870,27862,27869,684,2882,3089,3095,2881,2595,3084,3085,3111,3099,3100,3102,3103,3104,37] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.702,0.278,0.702]
select surf_pocket22, protein and id [6678,6731,6895,6896,6914,28267,28269,4335,4337,7166,7167,7183,7387,7385,7389,7374,6726,6729,6733,6732,6735,6675,6689,7369,6880,6681,6682,6683,4334,28225,28235,28261,28268,4322] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.902,0.361,0.863]
select surf_pocket23, protein and id [7387,7384,7385,7386,7388,7389,4318,7391,7395,7396,4337,28267,28269,4498,4487,4499,4334,4345,28225,4324,4329,28221,28224,28222,28273,28283,28289,28294,28266,28268,4322] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.278,0.643]
select surf_pocket24, protein and id [13833,13835,13794,13795,13797,13831,13798,13796,13718,29074,29078,29013,29014,13665,13682,13703,13926,13768,13767] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.361,0.792]
select surf_pocket25, protein and id [20131,20132,20133,20134,20146,20147,20229,20161,20165,24747,24748,20149,25056,25057,24725,24667,24744,25069,25058,25062,25063,24730,24733,24923,20141] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.278,0.588]
select surf_pocket26, protein and id [6141,6209,6126,6135,6123,6127,1804,6111,6112,6114,1809,2141,2002,1826,1827,1830,2148,6145,1746,2132,2135,2136,2142] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.361,0.722]
select surf_pocket27, protein and id [15451,10803,10804,10805,10806,15425,15448,15762,15763,15447,15422,15430,15433,15434,10837,15367,10818,10827,10832,10833,10901,10819,15623,15758,15756,15757,15769] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.278,0.533]
select surf_pocket28, protein and id [25007,25202,25203,25162,25163,25164,25165,25971,25972,26202,25161,25009,26203,25146,25149,25488,25143,25144,25771,25772,25773,25201,25200] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.361,0.647]
select surf_pocket29, protein and id [11587,28661,12077,12079,11875,11421,11423,11424,11427,11606,11572,11586,11588,11859] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.278,0.475]
select surf_pocket30, protein and id [10803,10804,11113,11112,11118,10813,15448,15447,15449,15450,15462,11125,15463,15545,10979] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.361,0.576]
select surf_pocket31, protein and id [2675,2678,2704,27843,27845,2451,27858,27859,2629,2643,2642,2641,2448,2443,2447,2452,2439,2435,2458,2718,2473] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.278,0.420]
select surf_pocket32, protein and id [3830,3869,3825,3909,4068,3808,3814,3823,3813,3820,3272,3884,3888,3791,3886,3887,3889,3890,3273,3245,3247] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.361,0.506]
select surf_pocket33, protein and id [6963,6988,6737,6740,6743,6758,6724,6728,6733,6732,6736,6926,6928,6927,6960,6987,7002,7003,6914,28242,28257,28258,6989,28244,6929] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.278,0.365]
select surf_pocket34, protein and id [15849,16472,16902,16471,16671,15864,15865,15861,15902,15903,16473,16672,15843,15844,15845,16188,15709,16903] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.361,0.431]
select surf_pocket35, protein and id [25372,25599,29820,29834,25564,29833,25596,25379,25563,25356,25368,25369,25370,25360,25364,25363,25394,25562,29818,25550,25625,25639] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.278,0.310]
select surf_pocket36, protein and id [19741,19743,19749,15674,15675,15676,19750,15673,19809,15678,19795,19755,19442,15595,15602,15604,19493,19494,15576,19744,19746,19441,19801,15590,15585] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.902,0.361,0.361]
select surf_pocket37, protein and id [11562,12062,11367,11572,12061,11375,11381,11373,11374,11143,11145,11556,15536,11147,11560,11382,15514,11154] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.702,0.310,0.278]
select surf_pocket38, protein and id [21355,21356,21586,20584,20585,20548,20586,20547,21157,20587,21587,20529,20530,20533,20872,21156,20527,20528] 
set surface_color,  pcol38, surf_pocket38 
set_color pcol39 = [0.902,0.431,0.361]
select surf_pocket39, protein and id [17435,17441,17444,17446,17451,17429,17489,17490,17681,16893,16894,17412,17505,17507,17509] 
set surface_color,  pcol39, surf_pocket39 
set_color pcol40 = [0.702,0.365,0.278]
select surf_pocket40, protein and id [16263,16264,16296,16299,16064,16068,16069,16060,16072,29033,29052,29035,16079,16094,16261,16262,16338,16324,16339,16323,16325,16250,29048,29049] 
set surface_color,  pcol40, surf_pocket40 
set_color pcol41 = [0.902,0.506,0.361]
select surf_pocket41, protein and id [26005,26006,25516,25091,25089,25506,25318,25319,25311,25325] 
set surface_color,  pcol41, surf_pocket41 
set_color pcol42 = [0.702,0.420,0.278]
select surf_pocket42, protein and id [4809,28174,28175,4404,27937,27930,27923,4812,27922,27939,27940,28074,4808,4827,4828,28159,4616,4829,27918] 
set surface_color,  pcol42, surf_pocket42 
set_color pcol43 = [0.902,0.576,0.361]
select surf_pocket43, protein and id [28331,28332,9091,28566,28567,9494,9515,9301,9302,9090,28552] 
set surface_color,  pcol43, surf_pocket43 
set_color pcol44 = [0.702,0.475,0.278]
select surf_pocket44, protein and id [11412,11416,11420,11424,11425,11450,11435,11606,28649,28650,11618,11652,11619,11620,11428,11655,11680,11681,11462,11695,11679,11694,28634,28636,11419] 
set surface_color,  pcol44, surf_pocket44 
set_color pcol45 = [0.902,0.647,0.361]
select surf_pocket45, protein and id [6675,6689,7369,7370,6880,6454,6455,6681,6682,6683] 
set surface_color,  pcol45, surf_pocket45 
set_color pcol46 = [0.702,0.533,0.278]
select surf_pocket46, protein and id [8169,8171,8172,8090,8093,8173,7557,8099,8105,8115,8153,8154] 
set surface_color,  pcol46, surf_pocket46 
set_color pcol47 = [0.902,0.722,0.361]
select surf_pocket47, protein and id [24691,24905,24978,24975,24976,10160,10416,10417,10418,10473,10415,10481,10107,10427,24904,24895,24902,24903,24876] 
set surface_color,  pcol47, surf_pocket47 
set_color pcol48 = [0.702,0.588,0.278]
select surf_pocket48, protein and id [7567,7336,6566,6567,7566,7335,6528,6525,6852,7135,7136,7137,6513] 
set surface_color,  pcol48, surf_pocket48 
set_color pcol49 = [0.902,0.792,0.361]
select surf_pocket49, protein and id [11827,11829,11257,11258,11259,12258,11256,11220,11828,11200,11201,11202,11205,11544,12028,12027] 
set surface_color,  pcol49, surf_pocket49 
set_color pcol50 = [0.702,0.643,0.278]
select surf_pocket50, protein and id [22193,22113,22114,22125,22189,22191,22135,22173,22174,22130,22134,21550,22118,22119,22124,21577,21578,22128] 
set surface_color,  pcol50, surf_pocket50 
set_color pcol51 = [0.902,0.863,0.361]
select surf_pocket51, protein and id [3576,3577,3355,3587,17236,17248,17249,3169,3170,17250,17241,27891,27898,3356,27886] 
set surface_color,  pcol51, surf_pocket51 
set_color pcol52 = [0.702,0.702,0.278]
select surf_pocket52, protein and id [14522,14524,14198,14521,14536,14538,14532,15002,15013,15015,14510,14962,14228,14229,14230] 
set surface_color,  pcol52, surf_pocket52 
set_color pcol53 = [0.863,0.902,0.361]
select surf_pocket53, protein and id [17197,17198,3615,16976,17208,3620,3627,3628,3629,16975,16977,16791] 
set surface_color,  pcol53, surf_pocket53 
set_color pcol54 = [0.643,0.702,0.278]
select surf_pocket54, protein and id [28540,11672,28411,28413,11673,28408,28409,28410,28539,28541,28543,28383] 
set surface_color,  pcol54, surf_pocket54 
   
        
        deselect
        
        orient
        