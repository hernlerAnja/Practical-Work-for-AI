
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/4MNE.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/4MNE.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [12062,12063,12064,12070,12071,12073,12069,11483,11602,11486,11603,13533,11607,11608,11610,11627,11631,11604,11197,11200,11201,11204,13928,14173,13927,14165,14171,14172,13929,13521,13529,13541,13532,13534,14189,13542,13947,11194,11195,13949,13918,13926,13682,13683,14139,14141,14147,13565,11441,11466,12112,13566,12095] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.408,0.702]
select surf_pocket2, protein and id [7522,7520,7503,7504,7505,7506,7543,7639,7640,7638,7637,7647,7664,6940,7653,7654,7769,7776,7778,7779,7795,7797,6071,7807,6052,7491,7838,7698,7699,7492,7495,7656,7774,7783,7788,7534,7535,7134,7635,7636,7642,7025,6939,7022,7010,7017,7018,7132,7011,7012,6936,6047,6051,7792,6615,6616,6617,6618,6622,6764,6780,6762,6763,7692,6916,7120,7121,6059,6054,6062,6041,7722,7719,7721,7694,7696,7669,7689,7690,7761,7764,6625,6060] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.475,0.902]
select surf_pocket3, protein and id [112,114,116,105,108,109,124,1023,1036,1035,1043,1007,1005,1006,1143,1198,1203,1004,996,115,1225,1226,1200,3950,993,992,1275,1278,1280,1282,1287,3960,3959,119,1264,1265,1273,1301,1292,1296,1299,1304,3929,3942,3946,3948,3949,3940,1311,997,141,257,258,1147,95,140,636,256,684,1034,1145,1146,1059,1058,1060,1138,1144,125,126,127,139,101,102,103,104,93,274,640,656,97,238,680,709,677,678,659,94,98] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.333,0.702]
select surf_pocket4, protein and id [2396,2397,3311,3313,2398,2902,2907,2911,308,2492,2494,2495,2857,2480,2882,2886,2885,2900,2488,2858,3315,3284,3398,3295,3400,3395,3399,2742,3394,2637,2373,2375,2374,2880,2879,2378,2372] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.376,0.902]
select surf_pocket5, protein and id [13557,13703,14118,14119,14120,14121,14122,14123,13702,13296,13696,13698,13195,13213,13212,13191,13192,13716,13721,13723,13695,13196,13701,13453,13311,14207,14208,13214,13308,13479,14210,14217,13558,14202,14203,14206,13678,13478,13659,13674,13673,14093,14092,13753,15435,15436,15437,13754,13727,13728,14103] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.306,0.278,0.702]
select surf_pocket6, protein and id [9767,9782,9783,9803,9765,9766,9771,9751,9752,9764,9903,9920,9753,9919,9755,9962,12598,12599,12601,12591,12593,10071,12580,12586,12590,10102,9963,10025,10038,12610,10052,10056,9900,9904,9906,9907,9892,9896,9901,9902,9911,9917,9918,9928,9199,9201,9278,9198,9271,12611,10218,9024,9025,9039,9986,9954,9985,9041,9382,9956,9177,9982,9981,9987,9988,9958,9393,9395,9381,9286,9283,9200,8879,8876,8891,8881,8882,8883,8886] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.443,0.361,0.902]
select surf_pocket7, protein and id [11134,11132,11133,11117,11119,11118,11120,9068,11576,11224,11228,11230,12125,12126,12129,12130,12131,11478,12043,12045,12046,11646,11650,11651,12015,12042,12044,11641,11398,11579,11399,11373,12132,12133,11231,11232,11593,11594,11611,11614,11618,11623,11622,11639,11214,11215,11216,11598,11477,11616,11615] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.384,0.278,0.702]
select surf_pocket8, protein and id [4914,4913,5480,5484,5034,5059,5476,5478,5071,5073,5074,5072,5054,5058,5057,4835,4652,4650,5050,5051,5052,5015,4655,4660,4651,5012,5029,5030,5474,5566,5567,5570,5571,5572,5574,4666,5482,5486,4551,4809,4568,4569,4570,4550,4664,5448,5449] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.541,0.361,0.902]
select surf_pocket9, protein and id [5503,5505,2718,3380,5510,5511,5514,3364,2750,2866,4922,2747,3381,5536,3331,3333,3338,3339,4890,2867,5038,5039,4919,4877,4885,5553] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.463,0.278,0.702]
select surf_pocket10, protein and id [274,1142,1148,1151,1196,440,441,621,622,1140,1141,1155,1157,1158,1168,1170,1194,257,258,1147,635,636,256,1145,1146,1138,1144,125,517,526,523,465,633,518,511,1006,1143,1202,1173,115,273,1224,1225,1226,3950,121,122,123,1160,112,114,124] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.643,0.361,0.902]
select surf_pocket11, protein and id [16135,16266,16267,16270,16271,16272,16273,16269,16268,16265,16152,16172,16165,16286,16274,16276,16277,16285,16283,16284,16322,15569,15570,16294,15640,15641,15642,15762,15764,15647,15649,16324,16328,16319,16299,16323,15546,16282,15394,16351,16352,15392,15408,15410,15765,15751,14692,15750,16320,15251,15257,15258,15260,15261,15259,15248,15252,15245] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.537,0.278,0.702]
select surf_pocket12, protein and id [9444,9445,9469,9470,9437,9419,9416,9436,9794,9907,9820,9819,9898,9400,9795,9796,9803,8862,8864,8906,8907,8908,9005,8861,8865,8879,8868,8869,8870,8872,8875,8876,8894,8891,8892,8893,8881,8882,9024,9025,9396] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.741,0.361,0.902]
select surf_pocket13, protein and id [8223,5784,6136,8197,5785,8194,8198,8199,12345,12912,12360,12373,12374,12911,12346,12347,12349,12187,8165,8166,12922,8225,8267,8228,8230,8255,12179,12180,12182,12183,12393,12382,8258,8256,12394,12956] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.616,0.278,0.702]
select surf_pocket14, protein and id [16121,16133,16134,16135,16269,16136,16152,16150,14682,14700,14701,14702,16437,14690,16430,16413,16418,16420,16422,16324,16329,16125,16328,16286,16276,16277,16285,16322,16111,16122,16390,16391,14688,15251,15255,16404,16371,14691,14692,16349,16351,16352,16320,16375,15253,15252] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.843,0.361,0.902]
select surf_pocket15, protein and id [7534,7183,7184,7533,7559,7643,7134,7135,7558,7641,7642,7133,6600,7207,7208,7209,7176,7179,6604,6603,7158,6744,7155,7139,6607,6609,6610,6647,6608,6645,6646,6601,6614,6611,6764,6763] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.694,0.278,0.702]
select surf_pocket16, protein and id [15814,15838,15788,15805,15806,15276,15233,15374,15393,15394,15277,15765,15229,15230,15235,15231,15234,15241,15242,15244,15245,15263,15275,16188,16265,15785,16272,16273,15813,16189,15809,16172,16164,16165,16163,15764] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.902,0.361,0.859]
select surf_pocket17, protein and id [4941,2710,2717,4633,3142,4630,4638,4639,4640,5503,5505,2716,2718,3365,5514,3364,2725,3120,3119,3121,3107,3079,3354,3105,3139,5043,5504,5064,5035,5039,4636,5040,5046,4637] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.702,0.278,0.627]
select surf_pocket18, protein and id [13274,13277,11870,11873,11841,11869,11453,11461,11462,11849,11850,11851,12095,12096,11852,11452,11454,11446,13585,13266,13687,13280,13684,13281,14140,14150,12088,13704,13708] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.902,0.361,0.757]
select surf_pocket19, protein and id [4889,4890,2464,2894,2895,2896,3333,3342,2458,2461,2465,2466,2468,2871,4897,5303,5282,5284,5274,5283,5285,5251,5526,2450,5537] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.702,0.278,0.553]
select surf_pocket20, protein and id [14094,14095,13746,14096,15433,15436,14082,14308,16380,16381,16382,15418,15420,14080,16361,16364,16363,16365,14307,14337,13747,15414] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.902,0.361,0.659]
select surf_pocket21, protein and id [308,3288,284,288,293,1255,300,304,303,3286,3273,1256,3274,1239,3287,3571,1241,1242,1234,1235,1237,1238,1240,2931,1253] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.702,0.278,0.475]
select surf_pocket22, protein and id [2496,3414,3416,3422,3400,3401,2636,2573,2598,2600,2601,2599,2605,2602,2381,2382,2495,2509,2511,2499,2505,2500,2512,2844,2491,2827,2607] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.902,0.361,0.561]
select surf_pocket23, protein and id [5792,12330,12331,12332,5738,5764,5765,5766,6350,6365,12320,12323,12325,6361,6357,12901,12902,5786,5790,6369,12912,12911,5784,12277,12910] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.278,0.396]
select surf_pocket24, protein and id [15368,15369,15663,15666,15668,15351,15353,15756,15675,15672,15686,15688,15690,15183,15185,15184,15316,15318,15320,15315,15317,15664,15665,15661,15662] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.361,0.459]
select surf_pocket25, protein and id [6000,6017,6020,7728,7732,7704,7709,7710,7712,7713,7683,7714,6843,6844,7703,7705,5138,5995,7735,5103,5137,5150,6824,5136,6821,6802,6809,6814,5139,5989,5981,5992,5979,5993,5994] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.278,0.318]
select surf_pocket26, protein and id [308,3288,284,288,290,1255,3286,3273,1256,3274,3285,3295,1254,3400,3257] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.361,0.361]
select surf_pocket27, protein and id [3869,3877,3881,3883,3908,3872,3905,2931,2965,2967,3867,1232,1236,3888,3880,324,315,345,1214,1218,1207,1208,303,2978,2962,2964,325,1216] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.318,0.278]
select surf_pocket28, protein and id [6738,6739,6553,6554,6555,6686,6688,6689,6690,6687,7043,7031,7032,7041,7042,7126,7127,7056,7057,7058,7059,7060,6536,6541,6543,7033] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.459,0.361]
select surf_pocket29, protein and id [6617,6622,6764,6780,6763,6778,6626,6627,6628,6629,6784,6630,6631,6779,6062,7718,7722,7716,7719,7720,6624,6798,7740,7505,7643] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.396,0.278]
select surf_pocket30, protein and id [112,116,106,109,1023,1021,1036,1035,699,700,701,1282,1301,1283] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.561,0.361]
select surf_pocket31, protein and id [9045,10016,9067,9046,9060,9064,12005,12222,12251,12018,9997,9999,11670,12017,12019,10001,10002,9995,10015,9998] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.475,0.278]
select surf_pocket32, protein and id [14614,16340,16344,16334,16342,16357,16358,14618,13747,15453,15432,15444,14619,14620,13778,13780,13781,13782,13783,16362,16365,14642,14645] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.659,0.361]
select surf_pocket33, protein and id [9063,9075,11703,12532,12533,9999,11670,12534,12520,12528,11705,11704,11706,12518,11701,9968,9978,9974,9976,9996,12559] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.553,0.278]
select surf_pocket34, protein and id [13458,13459,13429,13431,13432,13433,13434,13426,13424,13435,13612,13613,13082,8317,8318,13106,8354,13599,13600,13598] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.757,0.361]
select surf_pocket35, protein and id [49,534,1,5,532,533,183,627,233] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.627,0.278]
select surf_pocket36, protein and id [11918,12382,12384,12956,12954,12975,11920,8254,11892,12974,11925,11889,11924] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.902,0.859,0.361]
select surf_pocket37, protein and id [59,63,66,67,167,245,41,42,43,21,22,247,150,148,265,266] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.694,0.702,0.278]
select surf_pocket38, protein and id [11403,13095,13487,11016,11019,13092,13488,11407,11408,13483] 
set surface_color,  pcol38, surf_pocket38 
set_color pcol39 = [0.843,0.902,0.361]
select surf_pocket39, protein and id [4435,3205,3206,4616,3171,4442,4457,4443,4456,4468,4937] 
set surface_color,  pcol39, surf_pocket39 
   
        
        deselect
        
        orient
        