
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/7XLC.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/7XLC.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [6491,6492,6508,6509,7005,7007,7003,7004,7006,19560,19561,19562,6989,8587,5087,5117,17642,7929,7930,7931,7932,20487,6065,6066,7933,7937,5525,6046,5529,6047,6048,6049,6050,21093,6022,6459,21142,21143,21104,21107,21109,5086,5080,5083,5084,5058,5542,5063,5498,5499,5501,20190,21094,21089,7934,7938,6045,6475,6487,6488,6493,6506,6507,7001,7002,6999,6503,6504,7027,7024,7034,6988,6991,7026,6952,5106,7944,5539,5541,5572,6546,6547,6572,6455,6456,6454,6953,6457,6950,18600,19047,19048,19063,19060,19042,19046,19507,19543,19558,19559,19579,19544,18094,20484,20486,18079,18620,18621,20492,17666,17669,17670,17672,17661,18097,20478,20493,19064,20462,20463,20225,20482,20568,21063,20511,19557,19581,19589,19586,19587,19588,19594,21081,21060,21062,21292,21295,21286,20191,18650,19059,19097,19113,20426,20425,19101,19102,20427,20428,19602,19603,19608,20410,20411,19604,21306,21307,21309,21310,19609,19607,18669,19135,19138,19123,19134,19127,19128,18605,8588,8552,8554,17639,7956,18083,18085,7923,7924,7927,7909,7910,7911,7855,7871,7873,7856,7872,7032,7033,7039,8709,7031,7037,7049,7050,7053,7047,7048,6573,18601,18602,18577,18603,18604,19009,19010,19012,19013,19505,19508,19014,19016,18080,7668,8508,8539,7634,7635,7636,8013,8044,8505,8538,8537,8507,8534,8549,8526,8731,8737,8740,7670,8011,8012,8751,8753,18055,18576,18578,7603,7604,18057,18559] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.420,0.702]
select surf_pocket2, protein and id [12959,12972,13428,16289,16290,12961,12962,12964,12971,13411,16564,16568,16572,16610,16502,16449,16451,16354,12603,12604,12605,12613,12614,12615,12960,16551,16504,16499,16733,16737,16739,16740,16609,13869,13870,13871,16303,16304,16305,16308,10011,10013,10015,12985,12987,12988,13427,13867,10039,13444,10009,10012,13910,13912,9974,9976,13868,13905,13907,13888,9979,12653,12656,12626,12649,12623,12637,10041,16565,16566,10072,10073,10074,10075,16556,10077] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.498,0.902]
select surf_pocket3, protein and id [17698,17713,17716,18185,18187,18128,18143,17680,17685,17712,17722,17726,20502,20442,20443,20446,20503,20421,20439,20440,17775,18183,18186,18141,18171,18172,18173,18671,20445,20363,20393,20394,20374,20389,18725,18731,18728,20379,18096,18127,17666,17671,17679,17661,18110,18188,18189,17700] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.357,0.702]
select surf_pocket4, protein and id [8648,8650,8658,8659,21203,21205,21206,7005,7007,7000,7003,7006,19560,19562,6989,21142,21201,21140,21141,21143,21168,7029,7034,6986,6987,6992,8662,8665,21155,6999,19544,19545,19547,8602,8603,21217,19535,19542,19589,19590,21213,21214,21202,19469,8586,8588,8646,8647,7032,7035,7037] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.420,0.902]
select surf_pocket5, protein and id [22576,22573,22606,22608,59,4006,4010,4011,4001,22640,22642,22610,22540,22542,22543,101,71,433,76,94,58,68,54,57,60,404,97,279,80,22650,430,432,889,890,872,1312,1313,873,22553,22577,22578,22579,22580,22581,22582,1333,1352] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.278,0.298,0.702]
select surf_pocket6, protein and id [13994,13997,14393,14317,14318,14320,13794,14264,14652,14650,14704,15368,14209,14183] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.376,0.361,0.902]
select surf_pocket7, protein and id [3408,3411,3417,3493,3494,3394,3392,3409,3385,3384,3495,3549,3550,3564,3497,3499,3544,3348,820,821,822,372,371,3774,3777,3779,25,3496,3498,807,358,3360,8,1259,1223,1224,1261,3420,3244,3421,3422,3771,3772] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.325,0.278,0.702]
select surf_pocket8, protein and id [3750,1315,873,1316,3748,3749,3734,3735,872,55,58,49,50,54,60,404,406,407,408,409,3899,4013,4017,4053,4054,4055,59,4009,3947,3949,4182,4185,4178] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.455,0.361,0.902]
select surf_pocket9, protein and id [7948,5106,5143,5145,5541,5572,5573,7947,5111,5116,5124,5125,5130,5167,5161,5220,5628,5625,5633,5586,5588,5630,5632,5634,5615,5618,5624,5555,7931,7887] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.384,0.278,0.702]
select surf_pocket10, protein and id [1497,1498,1499,1495,1494,1496,1902,1493,1356,1357,1358,1359,926,927,1460,1459,22587,22588,22589,22590,22591,524,22618,22628,525,967,505,962,963,965,968,1373,1374,1376,1859,1413,1411,1856] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.533,0.361,0.902]
select surf_pocket11, protein and id [1689,1691,1729,1726,3259,1727,1210,3267,3268,3397,3081,3082,1670,3396,2924,2926,3090,3091,3092,3103,2894,2923,2925,1695,1178,3107,3110,1673,1175,1176,1725,2941,2942,2957,2962,3084] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.443,0.278,0.702]
select surf_pocket12, protein and id [14225,14246,14247,14248,14249,13765,15822,15823,15646,15647,15658,13732,15659,15662,14250,13731,13733,15665,15952,14282,14283,14284,15814,15517,15496,15497,15512,15473,15475,15476,15477,15479,15495,15639,15637,14226,14228,15449] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.612,0.361,0.902]
select surf_pocket13, protein and id [14307,14304,15798,14682,15501,15500,15502,15579,15581,15990,15574,15603,14279,14280,14282,14283,15814,15517,15516,15496,15512,15476,15811,15628,15625] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.506,0.278,0.702]
select surf_pocket14, protein and id [17991,18524,18525,18966,18967,18964,18965,18056,18030,18032,18578,7603,7604,8046,18559,7583,7586,7587,18414,18470,18472,18473,8042,8067,8071,8072,8074,18412,18430,18434,18431] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.690,0.361,0.902]
select surf_pocket15, protein and id [6004,6410,5477,5967,5968,5969,5970,20626,20629,6411,6412,6933,20141,5436,5918,5915,5917,6872,5859,5857,5875,5879,6862,20138,20158,20159,20601,20607,20608,20622] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.565,0.278,0.702]
select surf_pocket16, protein and id [7887,7889,7865,7866,7890,7809,6225,7834,7838,7839,6212,7818,7819,7820,7807,7808,7806,5625,5588,5615,5617,5618,5624,5616,6174,6176,6114,6115,6116,6117,6173,6181,5220] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.765,0.361,0.902]
select surf_pocket17, protein and id [13519,13521,13523,14053,14049,14051,13913,14048,13481,13482,13912,13914,14014,10020,10021,10022,10023,9984,9985,9986,14413,14414,13522,13518,13520,10061,13079,13080,13060] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.627,0.278,0.702]
select surf_pocket18, protein and id [1724,2127,1725,3026,3073,3243,3256,3435,2946,2941,2942,2944,2957,2960,2961,2962,3084,3070,1749,1752,1726,3259,1727,3019,3024] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.843,0.361,0.902]
select surf_pocket19, protein and id [23379,23215,21994,21995,23242,23370,23295,23296,23366,23297,22810,22811,23388,23217,22030,22031,22029,23389,23397,23402,23401,22781,22782] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.686,0.278,0.702]
select surf_pocket20, protein and id [1838,1428,1439,1709,1239,2101,1441,1442,905,908,1654,1086] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.902,0.361,0.878]
select surf_pocket21, protein and id [9474,9475,9476,10650,10215,10218,10243,10244,10835,10675,10799,10801,10803,9440,10674,10730,10729,10812,10802,10648,10834,9439] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.702,0.278,0.655]
select surf_pocket22, protein and id [5008,5010,5650,5417,5310,5703,5705,5706,4967,4968,4969,5360,4696,4971] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.902,0.361,0.800]
select surf_pocket23, protein and id [16051,12564,16053,16054,15949,15939,12580,12927,13362,12911,12912,16332,15972,13814,13816,13375,13376,13377,15963,15966] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.278,0.592]
select surf_pocket24, protein and id [7873,7856,7870,7872,7839,7840,6210,6212,6211,6573,8755,6114,6115,6116,6117,6586,6181,6185,6546,6547,6572,6579,6580,6570,6571] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.361,0.722]
select surf_pocket25, protein and id [18967,18965,7585,8569,7587,7528,19002,19459,19486,19511,19456,19416,19417,19415] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.278,0.533]
select surf_pocket26, protein and id [13666,13667,13668,14231,15414,15412,15429,15430,14150,14151,13628,13210,14229,15385,15386,14169,14172] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.361,0.647]
select surf_pocket27, protein and id [1007,486,1123,184,236,237,1124,182,629,543,542,1146,1122] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.278,0.471]
select surf_pocket28, protein and id [5199,5040,5042,5555,5009,4722,4723,5200,5142,5143,5145,5633,5632,5634] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.361,0.569]
select surf_pocket29, protein and id [13677,13678,13679,12792,12739,13596,13041,13562,13597,13701] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.278,0.412]
select surf_pocket30, protein and id [2053,2736,2749,2752,2444,2445,2446,2746,2506,2475,2507,2442,2458] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.361,0.490]
select surf_pocket31, protein and id [17822,17212,17213,17377,17508,17509,17525,17527,17864,17461,17462,17463,17464,17866,17915,17914,17865] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.278,0.349]
select surf_pocket32, protein and id [14546,14591,14592,14595,14596,14927,14930,14880,14893,14525,14840,14576,14837] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.361,0.412]
select surf_pocket33, protein and id [1616,1617,2859,655,2830,1057,1073,1074,1113,1111,2831,1676,2874,2875,1112] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.278,0.290]
select surf_pocket34, protein and id [2023,2285,2020,2019,2021,2036,2338,2359,2375,2377,2371,2372,2427,2040,2041,1970,2282,2283] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.384,0.361]
select surf_pocket35, protein and id [21903,21904,21905,21916,21917,23269,23251,20925,21897,21870,21896,21902,21502,23252,23254,21813,22899,21828,21829,21872,21974,21976,21977,21871,23231,21949,21920] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.329,0.278]
select surf_pocket36, protein and id [9316,9317,10664,10687,9349,9350,9361,9362,9365,9421,9422,9367,9341,9342,9274,9258,8371,8373,10684] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.902,0.463,0.361]
select surf_pocket37, protein and id [19128,20394,20395,18670,18671,18672,18669,19135,19138,19141,19126,19134,18760,18765,18766,18767,18736,18740,20411,20425] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.702,0.392,0.278]
select surf_pocket38, protein and id [14595,14596,14998,14999,15001,14594,14593,14602,14603,14608,15061,15291,15301,15305,15307,15304,15259,14997,15062] 
set surface_color,  pcol38, surf_pocket38 
set_color pcol39 = [0.902,0.541,0.361]
select surf_pocket39, protein and id [4680,4681,4991,5029,5475,5436,5477,4645] 
set surface_color,  pcol39, surf_pocket39 
set_color pcol40 = [0.702,0.451,0.278]
select surf_pocket40, protein and id [8073,8074,8083,8086,7422,7403,7620,7564,7507,7565,7567,7618] 
set surface_color,  pcol40, surf_pocket40 
set_color pcol41 = [0.902,0.620,0.361]
select surf_pocket41, protein and id [23029,23030,23086,24017,24042,24043,23087,22115,22148,22151,24045] 
set surface_color,  pcol41, surf_pocket41 
set_color pcol42 = [0.702,0.514,0.278]
select surf_pocket42, protein and id [22204,22206,22302,22304,24854,24088,24092,24094,24056,22203,24853] 
set surface_color,  pcol42, surf_pocket42 
set_color pcol43 = [0.902,0.698,0.361]
select surf_pocket43, protein and id [21905,21916,21906,21434,21435,21436,21919,21909,20963] 
set surface_color,  pcol43, surf_pocket43 
set_color pcol44 = [0.702,0.573,0.278]
select surf_pocket44, protein and id [2066,2101,2148,2813,1709,2067,1644,1652,2811,1705,1628] 
set surface_color,  pcol44, surf_pocket44 
set_color pcol45 = [0.902,0.776,0.361]
select surf_pocket45, protein and id [13952,13951,14792,14751,14752,13891,14370,14371,14739,14372,14377,14351,14335,14347,14742,14354,14353] 
set surface_color,  pcol45, surf_pocket45 
set_color pcol46 = [0.702,0.631,0.278]
select surf_pocket46, protein and id [2425,1990,2004,1592,2435,1961,2343,1962,1593,1594] 
set surface_color,  pcol46, surf_pocket46 
set_color pcol47 = [0.902,0.851,0.361]
select surf_pocket47, protein and id [8730,8731,8732,8733,8527,7424,7095,7567,7568,7425,7427,7468,7423] 
set surface_color,  pcol47, surf_pocket47 
set_color pcol48 = [0.702,0.694,0.278]
select surf_pocket48, protein and id [9649,9651,9652,9648,9748,9749,9750,12287,12286,11489,11525,11527,9747,11521] 
set surface_color,  pcol48, surf_pocket48 
set_color pcol49 = [0.871,0.902,0.361]
select surf_pocket49, protein and id [20108,20023,20116,20117,21108,21110,21248,21285,21286,21261,20039,19982,19984] 
set surface_color,  pcol49, surf_pocket49 
set_color pcol50 = [0.647,0.702,0.278]
select surf_pocket50, protein and id [17277,17286,17595,17598,17700,17754,17755,17276,17278,17275] 
set surface_color,  pcol50, surf_pocket50 
   
        
        deselect
        
        orient
        