
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/4HOK.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/4HOK.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [2336,2338,2340,2342,2341,3426,3428,3411,3418,3429,3430,3450,3427,2327,2329,2286,2309,2311,1086,1087,1088,1089,1092,2287,703,705,676,2324,3002,4695,3040,4698,4700,4711,4713,4710,3452,4712,637,1046,3041,1085,1053,1062,1063,4667,1064,1065,3451,3457,4649,4657,4672,2278] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.420,0.702]
select surf_pocket2, protein and id [12888,12920,12922,14140,14142,12900,12929,12930,14172,10561,10560,10569,10559,10535,10536,10537,10538,10539,12881,12882,10178,10180,14156,14158,14160,10150,12537,12539,14155,14170,14171,14173,10110,14169,10111,10520,10527,12511,12541,12472,11814,11800,11803,11812,11816,11818,11805,11785,11787,10176,12890,12897,11817,11762,12898,14117] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.506,0.902]
select surf_pocket3, protein and id [7070,7083,7085,7072,7067,5787,5794,7079,7029,8164,8165,8166,8167,5828,5827,5829,5830,5833,5826,5444,5446,5417,9429,9438,9442,9443,9444,9388,5803,9440,7739,8148,8155,7777,9431,8189,5804,5805,5806,9389,8187,8188,8190,8191,8194,5377,5378,9426,7778] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.369,0.702]
select surf_pocket4, protein and id [27031,27032,27038,28255,28257,28287,27033,28273,28275,28286,25942,28285,28288,28270,24657,24659,24650,24662,28284,24240,24241,27034,26992,26999,25941,24689,24690,24699,25886,25911,24691,27015,27009,27011,24666,24667,24669,28246,28232,28242,25927,25929,24309,25924,24280,24307,24279,26583,26622,26649,26651] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.361,0.439,0.902]
select surf_pocket5, protein and id [18884,15238,15247,15248,15250,15270,17183,17599,16519,17608,16521,15272,16510,16522,16523,15231,15271,15273,16467,16468,15277,16517,17592,17633,17640,18873,18875,18887,18888,18882,18885,18886,15245,17609,17610,17611,15249,15278,17631,17641,14888,14890,16505,14861,16508,17251,18871,18870,14822,17222] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.278,0.314,0.702]
select surf_pocket6, protein and id [23526,23549,23569,23567,23576,23580,23581,23582,23564,23578,19547,19972,22290,22297,22329,22330,22331,22332,22336,22291,21919,21239,19586,19613,21950,21248,21250,19615,21236,21880,21881,21920,23527,23518,22338,21946,21948,19973,19974,19975,19995,22308,22309,19996,19998,19997,20003,20004,20005,21241,19963,19956,22307,21251,21252,21253,21254,22306] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.361,0.373,0.902]
select surf_pocket7, protein and id [6011,5944,6237,6239,6803,6820,5952,6849,5954,6821,6822,6823,6824,5994,5996,5997,5990,5991,6007,5984,5992,20137,6852,6828,5620,5621,5622,5623,6847,5646,5647,5654,5655,5657,5658,5648,5618,19826,19828,19789,19790,19792,19824,19827,20123,20163,20165,20166,6857,6856,19791,6886,21055,21026,20993,6014,19333,19836,19837,19845,20138,6838,19799,19801,19763,19762,19793,19794,6806,6814,6807,6809] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.298,0.278,0.702]
select surf_pocket8, protein and id [2512,2513,2514,2619,2735,2736,2737,2358,2604,2965,2774,2966,2951,2357,2617,2490,2493,2495,2496,2621,3375,3503,2362,3508,3509,3510,3505,2990,3406,3502] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.416,0.361,0.902]
select surf_pocket9, protein and id [7100,7243,7259,7260,7261,7365,7367,7702,7703,7101,8248,7510,7511,7474,8112,8143,8240,8239,7727] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.349,0.278,0.702]
select surf_pocket10, protein and id [11832,11833,11996,11831,12874,12876,11998,12104,12973,12978,11979,11980,12435,12243,12244,12436,12975,12207,12205,12440,12875,11983,12102,12103,11997,12087,12421] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.486,0.361,0.902]
select surf_pocket11, protein and id [17428,17460,17463,25821,18625,18626,18627,17757,17759,25818,25816,25817,17793,17795,25791,25820,17790,17791,25753,18036,18038,18652,18623,17747,17810,17813,17755,17425,18619,25870,18606,25780,25813,25777,25872,25779,25849] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.404,0.278,0.702]
select surf_pocket12, protein and id [26588,26985,26986,26987,27083,27084,25956,25958,26577,25946,25955,26318,26078,26077,26194,26546,26547,26565,26568,26571,26101,26086,26102,26104,26209,26211,26103] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.553,0.361,0.902]
select surf_pocket13, protein and id [19992,19518,19519,19520,19993,20030,20031,19370,19393,19394,19377,19351,6736,6737,6739,6740,6742,6744,6769,6704,6707,6768,6777,19356,6868,19369,6746,19364,19362,19355] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.455,0.278,0.702]
select surf_pocket14, protein and id [21128,21181,21183,21185,21184,21087,21088,21089,21090,21117,21091,21092,21093,21127,21155,21097,21457,21130,21132,21133,21129,21131,21103,21065,6962,21182,6964,6922,6923,6934,6961,6963,6986,6958,6987,6988,7006,6992,7001,7004,7010,7013,21120,21161,21170,21175,19731,19733,6933,6935] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.620,0.361,0.902]
select surf_pocket15, protein and id [4625,213,85,182,4616,4623,83,90,80,211,3125,4612,4627,91,97,100,104,105,106,108,173,4720,3119,3120,3133,171,230,231,3135] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.510,0.278,0.702]
select surf_pocket16, protein and id [23497,23492,23494,22014,22012,23496,21999,23559,21998,22000,19141,19019,23590,19093,18996,19087,19089,19008,19086,19082,19084,19011,19080,22008,23476,18994,23485,23487,19123] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.690,0.361,0.902]
select surf_pocket17, protein and id [132,134,135,1040,1138,1139,601,371,408,409,151,153,259,260,1140,1143,1146,372,1041,1010,1021,4726,4733,4729,4728] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.565,0.278,0.702]
select surf_pocket18, protein and id [9626,9627,9628,9733,9734,9732,9844,9846,14193,14188,9882,9883,10074,10075,14189,9606,9609,10618,10620,10609,10612,10484,10515,10611,10099] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.757,0.361,0.902]
select surf_pocket19, protein and id [9457,9459,9460,4888,4868,4863,4865,4866,4867,4873,4874,4890,4995,4996,4997,5327,5341,5342,9464,5762,5885,5887,5879,5113,5876,5877,5884,5111,5112,5878,5782,5751,5781] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.616,0.278,0.702]
select surf_pocket20, protein and id [23599,19535,19534,19951,23598,19168,20047,19280,19281,19282,19169,19170,19510,19511,20045,20048,20053,20054,19949,19950,19062,19064,23597,19045] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.827,0.361,0.902]
select surf_pocket21, protein and id [21867,22285,21401,21402,21403,21845,21616,21652,21653,21508,21509,22382,22254,22265,22383,22384,22387,22388,22390,21267,21269,22283,22284,21270,21274,21385,21386,21492,21863] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.671,0.278,0.702]
select surf_pocket22, protein and id [2256,2252,2254,2543,2574,2536,2537,2441,2243,2245,2247,760,2468,2529,2530,2535,2458,764,768,2590,2592,2589,2534,2532,756,754,2444,2446,2241,2236] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.894,0.361,0.902]
select surf_pocket23, protein and id [6904,6866,6868,20012,6864,19773,6973,6683,6932,6935,21203,21204,21205,6897,19740,19741,19742,21200,21201,21202,6706,6707,6674,6682,6892,6899,6891,6898,6893,19979,19992,19991,20013,20001,20002,20010] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.278,0.678]
select surf_pocket24, protein and id [7214,7215,7216,7281,7338,5495,5496,5511,5497,5509,6995,6997,6999,7279,7205,7188,7208,7193,7192,6987,6988,7005,6990,7000,6979,7189,7290,7335,7336,7320,5513,7285] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.361,0.839]
select surf_pocket25, protein and id [24402,24427,25742,24458,24433,25743,25892,25893,25869,25891,25871,18610,25741,25781,25782,25714,25754,18586,18588,18589,18609,18618,18599,18608,24062,24706,24434,24436,24695,24696,17810,17809] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.278,0.624]
select surf_pocket26, protein and id [24644,24645,24740,24742,23975,24743,24747,24750,28301,28303,24739,28308,23741,23743,23760,23762,23867,23868,23869,24204,24205,24615,24616,24617,24614,24625,24246] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.361,0.769]
select surf_pocket27, protein and id [16437,16417,16433,16435,16636,16628,16629,16637,16776,14953,14955,16717,16719,16728,16626,16642,16643,16721,16722,16724,16443,16426,16651,16654,16646,14941,14949,14939,14940] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.278,0.573]
select surf_pocket28, protein and id [18665,18666,18667,25879,25866,25876,25878,25890,25892,25875,18639,18642,18617,18622,26172,26177,26173,26166,26169,18670,18671,27017,27018,18669,18542,18545,18547,18549,18578,18569,18570,18573,18574,18580,18571,18572,27019,26549,26552] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.902,0.361,0.702]
select surf_pocket29, protein and id [14314,15195,14323,14326,14315,14316,14322,15331,14449,14556,14310,18908,15206,14306,14341,14343,14447,14304,14305,15226,15323,14594,14827,18902,18903,18904,14785,14786] 
set surface_color,  pcol29, surf_pocket29 
set_color pcol30 = [0.702,0.278,0.518]
select surf_pocket30, protein and id [21339,21340,21164,21166,21168,19674,21157,21432,21462,21159,21169,19678,19680,21477,21479,21353,21356,21360,21361,21422,21423,21261,21231,19665,19664,21364,21427,21478] 
set surface_color,  pcol30, surf_pocket30 
set_color pcol31 = [0.902,0.361,0.631]
select surf_pocket31, protein and id [7858,7866,4818,4910,4840,4841,7856,7857,4816,4813,4912,4968,4915,4919,4950,4967,9338,7870,9356,7872,9354,9343,9358,9347,9452] 
set surface_color,  pcol31, surf_pocket31 
set_color pcol32 = [0.702,0.278,0.467]
select surf_pocket32, protein and id [23840,23782,23786,23778,23714,23715,26714,26716,28198,28200,28202,26718,28244,26700,26701,28265,23717,28295,23791,23807,28191,28182,23692,23694,23822,23795,28203,28208] 
set surface_color,  pcol32, surf_pocket32 
set_color pcol33 = [0.902,0.361,0.565]
select surf_pocket33, protein and id [6596,6599,6606,6614,6734,6757,6758,6759,6756,16845,17094,17104,6574,17105,17106,17107,17108,6761,6284,6168,6160,6161,17090] 
set surface_color,  pcol33, surf_pocket33 
set_color pcol34 = [0.702,0.278,0.412]
select surf_pocket34, protein and id [12074,12075,10244,11728,11730,11723,12016,12021,12027,11950,12018,11951,11953,10228,10229,10242,11732,11942,11945,12014,11795,11826] 
set surface_color,  pcol34, surf_pocket34 
set_color pcol35 = [0.902,0.361,0.498]
select surf_pocket35, protein and id [14372,17314,17316,18802,18798,18800,18791,18808,14402,14418,14419,14420,14282,14283,14361,14363,14359,14272,14266,17300,17301,14260,18865] 
set surface_color,  pcol35, surf_pocket35 
set_color pcol36 = [0.702,0.278,0.361]
select surf_pocket36, protein and id [14085,14087,9704,14067,14076,14083,9687,9657,14072,14093,14078,12603,12605,14129,9703,9705,14181,9576,9648,9568,9579,9647,12589,12590,14150] 
set surface_color,  pcol36, surf_pocket36 
set_color pcol37 = [0.902,0.361,0.427]
select surf_pocket37, protein and id [23446,23447,23449,22033,22039,22040,22046,22042,22064,22065,22066,22067,22034,23512,23445,23415,23419,23421,23531,23533,23504,16743,23510,16740] 
set surface_color,  pcol37, surf_pocket37 
set_color pcol38 = [0.702,0.278,0.306]
select surf_pocket38, protein and id [9757,10022,10035,10036,2016,10025,10023,10024,2013,2014,2018,1411,1412,1413,1421,9769,1856,1863,1831,10018] 
set surface_color,  pcol38, surf_pocket38 
set_color pcol39 = [0.902,0.361,0.361]
select surf_pocket39, protein and id [17146,16918,16917,17147,16539,17169,17684,17171,17587,16538,17681,17683,16681,16697,16699,16805] 
set surface_color,  pcol39, surf_pocket39 
set_color pcol40 = [0.702,0.306,0.278]
select surf_pocket40, protein and id [8973,9093,544,558,560,562,8958,8962,8965,8516,9118,9120,8639,9116,9117,8947,8933,9113,298,9115,283,548,549,550,551,299] 
set surface_color,  pcol40, surf_pocket40 
set_color pcol41 = [0.902,0.427,0.361]
select surf_pocket41, protein and id [26182,24372,24374,25852,25854,25856,26133,26059,26048,26122,26124,24358,25950,24359,25919,25898] 
set surface_color,  pcol41, surf_pocket41 
set_color pcol42 = [0.702,0.361,0.278]
select surf_pocket42, protein and id [21178,19712,21201,21203,19731,19733,6933,6935,21122,19706,21118,21120,19699,19701,19700,19730,21184,21087,21090,21117,21091,21092,21182,6934] 
set surface_color,  pcol42, surf_pocket42 
set_color pcol43 = [0.902,0.498,0.361]
select surf_pocket43, protein and id [1679,1680,1671,1753,1754,1794,1683,1377,1378,1380,1381,1367,1373,1372,1659] 
set surface_color,  pcol43, surf_pocket43 
set_color pcol44 = [0.702,0.412,0.278]
select surf_pocket44, protein and id [16400,16401,16402,16397,16398,16399,21694,22133,22135,22131,21701,21703,22126,22124,22125,22127,22128,22097,22161,22162,16372] 
set surface_color,  pcol44, surf_pocket44 
set_color pcol45 = [0.902,0.565,0.361]
select surf_pocket45, protein and id [22611,22612,22616,22617,22618,22621,22994,22993,23034,22622,22624,22625,22903,22915,22919,22923,22927,22906] 
set surface_color,  pcol45, surf_pocket45 
set_color pcol46 = [0.702,0.467,0.278]
select surf_pocket46, protein and id [12396,12397,12127,12385,12386,18564,18391,18396,18402,18409,17959,17960,12139,17992,18406,18561,18562,18560,17967,18377] 
set surface_color,  pcol46, surf_pocket46 
set_color pcol47 = [0.902,0.631,0.361]
select surf_pocket47, protein and id [24337,24313,24314,24322,25958,24310,25953,25954,25957,24309,24308,24303,24307,24312,24315,26611,26612,26613,25917] 
set surface_color,  pcol47, surf_pocket47 
set_color pcol48 = [0.702,0.518,0.278]
select surf_pocket48, protein and id [5401,5755,5740,5468,6140,6141,6347,6349,6425,6127,6128,6114] 
set surface_color,  pcol48, surf_pocket48 
set_color pcol49 = [0.902,0.702,0.361]
select surf_pocket49, protein and id [14842,14843,14844,14845,15198,15579,15197,15199,15184,15578,15566,15552] 
set surface_color,  pcol49, surf_pocket49 
set_color pcol50 = [0.702,0.573,0.278]
select surf_pocket50, protein and id [5302,4202,5303,3785,4389,4387,4193,5292,5020,5036] 
set surface_color,  pcol50, surf_pocket50 
set_color pcol51 = [0.902,0.769,0.361]
select surf_pocket51, protein and id [24972,24976,25394,25354,24977,24978,24981,25266,25283,25284,25263,24984,24985,25353,24971] 
set surface_color,  pcol51, surf_pocket51 
set_color pcol52 = [0.702,0.624,0.278]
select surf_pocket52, protein and id [5093,5095,5119,5160,5262,5263,5127,5128,5264] 
set surface_color,  pcol52, surf_pocket52 
set_color pcol53 = [0.902,0.839,0.361]
select surf_pocket53, protein and id [17366,17367,17369,17348,18810,18813,18754,18756,18816,18818,18721,18751,18752,18720,18725,18726,17342,18711,18712,17336,18728,18837,18839] 
set surface_color,  pcol53, surf_pocket53 
set_color pcol54 = [0.702,0.678,0.278]
select surf_pocket54, protein and id [7140,7141,7142,7159,7163,21453,21439,21318,21320] 
set surface_color,  pcol54, surf_pocket54 
set_color pcol55 = [0.894,0.902,0.361]
select surf_pocket55, protein and id [28026,28027,27159,27157,27190,27191,27195,27193,27438] 
set surface_color,  pcol55, surf_pocket55 
set_color pcol56 = [0.671,0.702,0.278]
select surf_pocket56, protein and id [12355,12213,12254,12356,12188,12190,12221,12222,12354] 
set surface_color,  pcol56, surf_pocket56 
set_color pcol57 = [0.827,0.902,0.361]
select surf_pocket57, protein and id [397,398,1173,427,945,946,1190,383,361,362,1188] 
set surface_color,  pcol57, surf_pocket57 
   
        
        deselect
        
        orient
        